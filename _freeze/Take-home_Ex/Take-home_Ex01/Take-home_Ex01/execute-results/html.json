{
  "hash": "f66e447baf21281d090c709bf20a30fe",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex01\"\nauthor: \"NeoYX\"\ndate: '7 May 2023'\n#date-modified: \"2023-05-07\"\neditor: visual\nexecute: \n  freeze: auto\n  warning: false\n  #echo: false\n  #message: false\n  html:\n    code-fold: True\n    code-overflow: scroll\n    code-summary: \"Show the code\"\n    code-line-numbers: true\n---\n\n\n# 1. Task and Dataset\n\nThis exerises aims to reveal the demographic and financial characteristics of the city of Engagement, using appropriate **static and interactive statistical graphics** methods. It also requires a user-friendly and interactive solution that helps city managers and planners to explore the complex data in an engaging way and reveal hidden patterns.\n\nThe dataset consists of a sample survey of 1000 representative residents that collects data related to their household demographic and spending patterns, among other things. There are primarily two datasets used in this exercise\n\n-   'FinancialJournal.csv\": Contains 1513635 number of daily transaction records (different categories of income and expenses) over a period of twelve months from March 2022 to February 2023.\n\n<!-- -->\n\n-   'Particpants.csv\" : Contains demographics information like household size, age, education level, interest groups, joviality index and whether each household has kids.\n\nIn this exercise, each dataset will be cleansed separately and then joined by 'participantID' as primary key to form the final dataset used for further analysis.\n\n# \n\n# 2. Data Preparation\n\n## 2.1 Install and load the required libraries\n\nThe code chunk below uses `pacman::p_load()` to check if packages are installed. If they are, they will be launched into R. The packages installed are\n\n-   `plotly`: Used for creating interactive web-based graphs.\n\n-   `knitr`: Used for dynamic report generation\n\n-   `patchwork`: Used to combine plots\n\n-   `tidyverse`: A collection of core packages designed for data science, used extensively for data preparation and wrangling.\n\n-   `ggthemes`: Provide additional themes for `ggplot2`\n\n-   `ggstatsplot`: Used for creating graphics with details from statistical tests.\n\n-   `ggdist`: Used for visualising distribution and uncertainty\n\n-   \n\n-   \n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(plotly, knitr, patchwork, tidyverse, ggthemes,hrbrthemes, ggstatsplot, ggdist, png, gifski, nortest)\n```\n:::\n\n\n## 2.2 Import the dataset\n\nThe datasets are imported using `tidyverse`'s `readr::read_csv()` function.\n\n'FinancialJournal.csv\" is stored as `finance` variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance <- read_csv('data/FinancialJournal.csv')\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  participantId timestamp           category  amount\n          <dbl> <dttm>              <chr>      <dbl>\n1             0 2022-03-01 00:00:00 Wage      2473. \n2             0 2022-03-01 00:00:00 Shelter   -555. \n3             0 2022-03-01 00:00:00 Education  -38.0\n4             1 2022-03-01 00:00:00 Wage      2047. \n5             1 2022-03-01 00:00:00 Shelter   -555. \n6             1 2022-03-01 00:00:00 Education  -38.0\n```\n:::\n:::\n\n\nCheck for empty values in the `finance` table using the `is.na()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(finance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n'Particpants.csv\" is stored as `ptcp` variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp <- read_csv('data/Participants.csv')\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  participantId householdSize haveKids   age educationLevel      interestGroup\n          <dbl>         <dbl> <lgl>    <dbl> <chr>               <chr>        \n1             0             3 TRUE        36 HighSchoolOrCollege H            \n2             1             3 TRUE        25 HighSchoolOrCollege B            \n3             2             3 TRUE        35 HighSchoolOrCollege A            \n4             3             3 TRUE        21 HighSchoolOrCollege I            \n5             4             3 TRUE        43 Bachelors           H            \n6             5             3 TRUE        32 HighSchoolOrCollege D            \n# ℹ 1 more variable: joviality <dbl>\n```\n:::\n:::\n\n\nChecking for empty values in `ptcp` table using the `is.na()`\\` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(ptcp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n## 2.3 Data Issues and wrangling\n\nI will discuss the issues in the datasets and proposed cleaning methods.\n\n### 2.3.1 `finance` dataset issues:\n\n-   **participantId** should be converted from `<dbl>` format to `<chr>` format. It should be a categorical and not numerical data type.\n\n-   **timestamp** should be converted from `<dttm>` format to `<date>` format as I will not be analysing time in this exercise.\n\n-   Negative values of **amount** that belong to the expenses categories should be converted to positive values. The amount will also be rounded to two decimal places.\n\nThe code chunk below does the following:\n\n-   use the **`as.character()`** function to convert **participantId** to `<chr>` format\n\n-   create a new column **month_year** by extracting the year and month from the **timestamp** column using the **`format()`** function with the **`%Y-%m`** format specifier.\n\n-   use the **`abs()`** function to convert negative values **amount** to positive and round the values to 2 decimal places using the **`round()`** function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert participantId to character\nfinance <- finance %>% mutate(participantId = as.character(participantId))\n\n# Extract month and year from timestamp\nfinance <- finance %>% \n  mutate(month_year = format(timestamp, \"%m-%Y\"))\n\n# Transform negative amounts to positive and round to 2 decimal places\nfinance <- finance %>% \n  mutate(amount = abs(amount),\n         amount = round(amount, 2))\n```\n:::\n\n\nA check for duplicates using the `duplicated()` function reveals that there are 1,113 records of duplicates.\n\n-   The **`duplicated()`** function to identify the duplicate rows. It returns a logical vector indicating whether each row is a duplicate of a previous row in the data frame. We can then use this logical vector to subset the data frame and show the duplicate rows. The logical vector is stored in a filter **duplicated_rows** which is used to subset the `finance` data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Show duplicate rows\nduplicated_rows <- finance[duplicated(finance),]\nglimpse(duplicated_rows)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,113\nColumns: 5\n$ participantId <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"…\n$ timestamp     <dttm> 2022-03-01, 2022-03-01, 2022-03-01, 2022-03-01, 2022-03…\n$ category      <chr> \"Shelter\", \"Education\", \"Shelter\", \"Education\", \"Shelter…\n$ amount        <dbl> 554.99, 38.01, 554.99, 38.01, 556.55, 12.81, 554.99, 38.…\n$ month_year    <chr> \"03-2022\", \"03-2022\", \"03-2022\", \"03-2022\", \"03-2022\", \"…\n```\n:::\n:::\n\n\n-   **`unique()`** function is used to remove the duplicate rows form `finance` data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove duplicate rows\nfinance <- unique(finance)\n```\n:::\n\n\n-   Perform a final check to verify that there are no more duplicate using `any()` function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(finance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nThe last thing to do is to create a new colunm **date** that is in \\<date\\> format using the `as.Date` function.\n\n-   the paste0() function is used to concatenate \"01-\" with each value in the month_year column. This is because as.Date() requires a complete date in the format \"dd-mm-yyyy\"\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    finance$date <- as.Date(paste0(\"01-\", finance$month_year), format = \"%d-%m-%Y\")\n    ```\n    :::\n\n\n**Other issues**\n\nWhen the `finance` dataset is groupby the **date** variable , it is noticed that the number of distinct participantID who took part in the survey was 1,011 in March 2022 and suddenly reduced to a constant value of 880 from April 2022 onwards. It seems to suggest that there are 131 residents who moved out of the city at the end of March 2022.\n\nIn the code chunk below:\n\n-   dataset is group-by **date** and the distinct count of **participantID** is generated using `n_distinct` function\n\n-   the **missing** dataframe is displayed below using `knitr::kable()` function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_summary <- finance %>%\n  group_by(date) %>% \n  summarise(n_distinct=n_distinct(participantId)) %>% \n  rename(`Number of unique participantId` = n_distinct)\n\nknitr::kable(missing_summary, \"simple\")\n```\n\n::: {.cell-output-display}\ndate          Number of unique participantId\n-----------  -------------------------------\n2022-03-01                              1011\n2022-04-01                               880\n2022-05-01                               880\n2022-06-01                               880\n2022-07-01                               880\n2022-08-01                               880\n2022-09-01                               880\n2022-10-01                               880\n2022-11-01                               880\n2022-12-01                               880\n2023-01-01                               880\n2023-02-01                               880\n:::\n:::\n\n\nSince 11 out of 12 months of records are missing for these 131 residents, we will delete their records from the `finance` dataset.\n\nThe code chunk below will extract the **participantIds** of residents whose records exists in March 22 but not in all April 22. The **participantIds** will be stored in a vector called **missing_id_vector.**\n\nThis code will filter the **`finance`** dataframe for rows with **`date`** equal to '2022-03-01', and then perform an anti-join with a filtered dataframe containing rows with **`date`** equal to '2022-04-01', based on the common **`participantId`** column. The resulting dataframe will only contain **`participantId`**s that are in '2022-03-01' but not in '2022-04-01'. The **`select`** function is used to extract the **`participantId`** column from the resulting dataframe.\n\nIn this code, we assign the result of your code to a variable named **`result`**. Then we use the **`pull()`** function to extract the **`participantId`** column from **`result`**. We pass the **`participantId`** column name as an argument to **`pull()`**. Next, we use the **`as.vector()`** function to convert the resulting tibble column to a vector. Finally, we assign the resulting vector to a variable named **`result_vector`** and print it. The resulting **`result_vector`** should be a numeric vector containing the unique **`participantId`** values from your code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_id <- finance %>%\n  filter(date == as.Date('2022-03-01')) %>% # filter for '2022-03-01' date\n  anti_join(finance %>%\n             filter(date == as.Date('2022-04-01')), # filter for '2022-04-01' date\n             by = 'participantId') %>% # anti-join by 'participantId'\n  select(participantId) %>% \n  distinct(participantId)\n\n# extract participantId column as convert this column to vector.\nmissing_id_vector <- as.vector(pull(missing_id, participantId))\n\nmissing_id_vector \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"44\"  \"127\" \"142\" \"154\" \"161\" \"256\" \"262\" \"267\" \"279\" \"285\" \"288\" \"298\"\n [13] \"301\" \"346\" \"352\" \"356\" \"380\" \"382\" \"383\" \"384\" \"392\" \"406\" \"407\" \"509\"\n [25] \"510\" \"512\" \"514\" \"523\" \"526\" \"539\" \"541\" \"553\" \"558\" \"567\" \"568\" \"572\"\n [37] \"574\" \"575\" \"577\" \"580\" \"589\" \"595\" \"599\" \"602\" \"603\" \"604\" \"605\" \"611\"\n [49] \"615\" \"617\" \"621\" \"628\" \"629\" \"634\" \"639\" \"641\" \"643\" \"647\" \"653\" \"655\"\n [61] \"657\" \"658\" \"663\" \"668\" \"670\" \"756\" \"757\" \"760\" \"761\" \"762\" \"768\" \"771\"\n [73] \"773\" \"774\" \"780\" \"785\" \"789\" \"790\" \"791\" \"792\" \"793\" \"794\" \"799\" \"802\"\n [85] \"806\" \"808\" \"816\" \"817\" \"818\" \"824\" \"825\" \"827\" \"828\" \"831\" \"832\" \"834\"\n [97] \"839\" \"842\" \"846\" \"847\" \"853\" \"855\" \"856\" \"858\" \"859\" \"860\" \"862\" \"864\"\n[109] \"867\" \"872\" \"875\" \"876\" \"883\" \"884\" \"885\" \"886\" \"887\" \"892\" \"896\" \"897\"\n[121] \"900\" \"901\" \"902\" \"907\" \"909\" \"911\" \"919\" \"920\" \"923\" \"924\" \"925\"\n```\n:::\n:::\n\n\nNext, we will remove all records of the 131 potentially non-residents from the `finance` dataset .\n\nIn the code chunk below:\n\nwe use the **`%in%`** operator to check if each **`id`** value is contained in the missing_id_vector. Then we use the negation operator **`!`** to negate this condition, which gives us a logical vector indicating which rows in **`df1`** should be included in the filtered data frame. Finally, we use this logical vector to index **`df1`** and extract only the rows that satisfy the condition. The resulting filtered data frame will not contain the rows where the **`id`** values are 4 or 5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance1 <- finance[!finance$participantId %in% missing_id_vector, ]\nfinance1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,509,897 × 6\n   participantId timestamp           category  amount month_year date      \n   <chr>         <dttm>              <chr>      <dbl> <chr>      <date>    \n 1 0             2022-03-01 00:00:00 Wage      2473.  03-2022    2022-03-01\n 2 0             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01\n 3 0             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01\n 4 1             2022-03-01 00:00:00 Wage      2047.  03-2022    2022-03-01\n 5 1             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01\n 6 1             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01\n 7 2             2022-03-01 00:00:00 Wage      2437.  03-2022    2022-03-01\n 8 2             2022-03-01 00:00:00 Shelter    557.  03-2022    2022-03-01\n 9 2             2022-03-01 00:00:00 Education   12.8 03-2022    2022-03-01\n10 3             2022-03-01 00:00:00 Wage      2367.  03-2022    2022-03-01\n# ℹ 1,509,887 more rows\n```\n:::\n:::\n\n\nWe will double check that the records of 131 non-residents have been removed from `finance1` dataframe.\n\nin the code below\n\nwe use the **`distinct()`** function to extract the distinct **`participantId`** values from **`finance1`**. We pass **`participantId`** as an argument to **`distinct()`** to extract only the unique values of this column. Finally, we use the **`n_distinct()`** function to count the number of distinct **`participantId`** values in the resulting tibble.\n\nThe resulting **`distinct_count`** variable should contain the count of distinct **`participantId`** values in **`finance1`**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance1 %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 880\n```\n:::\n:::\n\n\n### 2.3.2 `ptcp` dataset issues:\n\n-   **participantId** should be converted from `<dbl>` format to `<chr>` format\n\n-   **householdSize** should be converted from `<dbl>`{style=\"caret-color: white;\"} format to `<fct>`{style=\"caret-color: white;\"} format. It does not make sense to have 2.5 persons.\n\n-   **age** should be converted from `<dbl>`{style=\"caret-color: white;\"} format to `<int>`{style=\"caret-color: white;\"} format.\n\n-   **educationLevel** should be converted from `<chr>` to `<fct>` . It should also be ordered according to 'Low', 'HighSchoolOrCollege', 'Bachelors' and 'Graduate'.\n\nThe code chunk below does the following:\n\n-   `as.character` and `as.factor` functions are used to convert **participantId** to `<chr>` , **householdSize** to `<fct>` and **age** to `<int>`.\n\n-   `factor(educationLevel, levels=c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")))` not only converts **educationLevel** to factor, but also order the values inside.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert to factor\nptcp <- ptcp %>% mutate(participantId = as.character(participantId))\nptcp <- ptcp %>% mutate(householdSize = as.factor(householdSize))\n\n# Convert educationLevel to factor and order accordingly\nptcp <- ptcp %>% mutate(educationLevel = factor(educationLevel, levels=c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")))\n\n# convert age to int\nptcp <- ptcp %>% mutate(age = as.integer(age))\n```\n:::\n\n\nThe columns format are all in order now.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ptcp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,011\nColumns: 7\n$ participantId  <chr> \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\",…\n$ householdSize  <fct> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…\n$ haveKids       <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…\n$ age            <int> 36, 25, 35, 21, 43, 32, 26, 27, 20, 35, 48, 27, 34, 18,…\n$ educationLevel <fct> HighSchoolOrCollege, HighSchoolOrCollege, HighSchoolOrC…\n$ interestGroup  <chr> \"H\", \"B\", \"A\", \"I\", \"H\", \"D\", \"I\", \"A\", \"G\", \"D\", \"D\", …\n$ joviality      <dbl> 0.001626703, 0.328086500, 0.393469590, 0.138063446, 0.8…\n```\n:::\n:::\n\n\nUse `distinct()` and `n_distinct()` to check on the number of unique participantIds in `ptcp` table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1011\n```\n:::\n:::\n\n\nCurrently, the `ptcp` table still contain the demographic records of the 131 residents who moved out. Let us remove their records by using similar method used in removing the same records in `financial` table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp1 <- ptcp[!ptcp$participantId %in% missing_id_vector, ]\n\nptcp1 %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 880\n```\n:::\n:::\n\n\nBoth `finance1` and `ptcp1` tables now contains information about the same number of participantIds.\n\n### 2.3.3 Convert `finance1` table to wide format and perform left outer join with `ptcp1` table.\n\nWe will now convert the `finance1` dataframe from a long to a wide format. The code chunk below does the followingL\n\n-   group the data by **participantId** , **date** and **category** using the **`group_by`** function\n\n-   use the `sum` function to calculate the total monthly amount for each **category** per **participantId** per **month**\n\n-   the `pivot_wider` function will convert the **category** column to wide format with total monthly values in the **amount** column.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    finance1_wide<- finance1 %>%\n      group_by(participantId, date, category) %>%\n      summarise(total_amount = sum(amount)) %>%\n      pivot_wider(names_from = category, values_from = total_amount)\n    ```\n    :::\n\n    ::: {.cell}\n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 10,560 × 8\n    # Groups:   participantId, date [10,560]\n       participantId date       Education  Food Recreation Shelter   Wage\n       <chr>         <date>         <dbl> <dbl>      <dbl>   <dbl>  <dbl>\n     1 0             2022-03-01      38.0  268.      349.     555. 11932.\n     2 0             2022-04-01      38.0  266.      219.     555.  8637.\n     3 0             2022-05-01      38.0  265.      383.     555.  9048.\n     4 0             2022-06-01      38.0  257.      466.     555.  9048.\n     5 0             2022-07-01      38.0  270.     1069.     555.  8637.\n     6 0             2022-08-01      38.0  262.      314.     555.  9459.\n     7 0             2022-09-01      38.0  256.      295.     555.  9048.\n     8 0             2022-10-01      38.0  267.       25.0    555.  8637.\n     9 0             2022-11-01      38.0  261       377.     555.  9048.\n    10 0             2022-12-01      38.0  266.      357.     555.  9048.\n    # ℹ 10,550 more rows\n    # ℹ 1 more variable: RentAdjustment <dbl>\n    ```\n    :::\n    :::\n\n\n    ::: callout-note\n    About finance1_wide table\n\n    `finance_wide` is a table that has one row for each unique combination of **participantId** and **month** and one column for each unique category from the former `finance1` table.\n    :::\n\n    The code chunk below performs a left outer join with finance1_wide table (left) and ptcp1 table (right) with join key **participantId**.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    # left outer join\n    finance1_wide_ptcp1 <- left_join(finance1_wide, ptcp1, by = \"participantId\")\n    ```\n    :::\n\n\n    The cleansed finance1_wide_ptcp1 is displayed using `knitr::kable()`{style=\"caret-color: white;\"} function\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    knitr::kable(head(finance1_wide_ptcp1,24), \"simple\") \n    ```\n    \n    ::: {.cell-output-display}\n    participantId   date          Education     Food   Recreation   Shelter       Wage   RentAdjustment  householdSize   haveKids    age  educationLevel        interestGroup    joviality\n    --------------  -----------  ----------  -------  -----------  --------  ---------  ---------------  --------------  ---------  ----  --------------------  --------------  ----------\n    0               2022-03-01        38.01   268.26       348.68    554.99   11931.95               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-04-01        38.01   265.79       219.42    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-05-01        38.01   264.54       382.99    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-06-01        38.01   256.90       465.67    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-07-01        38.01   270.13      1069.48    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-08-01        38.01   261.76       314.13    554.99    9459.44               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-09-01        38.01   256.04       294.64    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-10-01        38.01   266.67        25.01    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-11-01        38.01   261.00       377.41    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-12-01        38.01   265.98       356.69    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2023-01-01        38.01   264.97       209.77    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2023-02-01        38.01   239.05       319.93    554.99    8225.60               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    1               2022-03-01        38.01   289.00      1047.91    554.99   10358.99               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-04-01        38.01   256.66       515.32    554.99    7589.61               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-05-01        38.01   258.17       358.55    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-06-01        38.01   261.04       675.33    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-07-01        38.01   270.64       505.12    554.99    7589.61               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-08-01        38.01   270.88       438.13    554.99    8312.43               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-09-01        38.01   255.09       387.97    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-10-01        38.01   264.66       382.13    554.99    7589.61               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-11-01        38.01   257.88       627.93    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2022-12-01        38.01   283.84      1077.56    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2023-01-01        38.01   266.38       328.69    554.99    7951.02               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    1               2023-02-01        38.01   233.69       292.78    554.99    7228.20               NA  3               TRUE         25  HighSchoolOrCollege   B                0.3280865\n    :::\n    :::\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    finance1_wide_ptcp1\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 10,560 × 14\n    # Groups:   participantId, date [10,560]\n       participantId date       Education  Food Recreation Shelter   Wage\n       <chr>         <date>         <dbl> <dbl>      <dbl>   <dbl>  <dbl>\n     1 0             2022-03-01      38.0  268.      349.     555. 11932.\n     2 0             2022-04-01      38.0  266.      219.     555.  8637.\n     3 0             2022-05-01      38.0  265.      383.     555.  9048.\n     4 0             2022-06-01      38.0  257.      466.     555.  9048.\n     5 0             2022-07-01      38.0  270.     1069.     555.  8637.\n     6 0             2022-08-01      38.0  262.      314.     555.  9459.\n     7 0             2022-09-01      38.0  256.      295.     555.  9048.\n     8 0             2022-10-01      38.0  267.       25.0    555.  8637.\n     9 0             2022-11-01      38.0  261       377.     555.  9048.\n    10 0             2022-12-01      38.0  266.      357.     555.  9048.\n    # ℹ 10,550 more rows\n    # ℹ 7 more variables: RentAdjustment <dbl>, householdSize <fct>,\n    #   haveKids <lgl>, age <int>, educationLevel <fct>, interestGroup <chr>,\n    #   joviality <dbl>\n    ```\n    :::\n    :::\n\n\n    # 3. Visualisation\n\n    ## 3.1 High level EDA of city's monthly total income vs total expenses\n\n    In this exercise, I will explore the dataset from high level and then zoom into interesting patterns (if I can find any =))\n\n    We categorise Education, Food, Recreation, Shelter into **Expenses** while RentAdjustment, Wage are categorised into **Income**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    highlevel <- finance1_wide_ptcp1 %>%\n      group_by(date) %>%\n      summarize(Education = sum(Education, na.rm = TRUE),\n                Food = sum(Food, na.rm = TRUE),\n                Recreation = sum(Recreation, na.rm = TRUE),\n                Shelter = sum(Shelter, na.rm = TRUE),\n                Wage = sum(Wage, na.rm = TRUE),\n                RentAdjustment = sum(RentAdjustment, na.rm = TRUE),\n                ExpenseP = sum(Education, Food, Recreation, Shelter),\n                Income = sum(Wage, RentAdjustment),\n                Saving = Income - ExpenseP,\n                Expense = ExpenseP * -1\n                )\n    highlevel\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 12 × 11\n       date       Education   Food Recreation Shelter   Wage RentAdjustment ExpenseP\n       <date>         <dbl>  <dbl>      <dbl>   <dbl>  <dbl>          <dbl>    <dbl>\n     1 2022-03-01    11424. 3.20e5    649580. 631623. 6.07e6         53504. 1612753.\n     2 2022-04-01    11424. 3.04e5    389688. 559919. 3.47e6          1429. 1265312.\n     3 2022-05-01    11424. 3.14e5    336413. 558451. 3.62e6             0  1219825.\n     4 2022-06-01    11424. 3.03e5    314804. 558451. 3.61e6             0  1187571.\n     5 2022-07-01    11424. 3.14e5    329608. 558451. 3.49e6             0  1213285.\n     6 2022-08-01    11424. 3.13e5    306957. 558451. 3.76e6             0  1189655.\n     7 2022-09-01    11424. 3.03e5    301906. 558451. 3.61e6             0  1174642.\n     8 2022-10-01    11424. 3.14e5    326716. 558451. 3.48e6             0  1210151.\n     9 2022-11-01    11424. 3.03e5    288286. 558451. 3.61e6             0  1160991.\n    10 2022-12-01    11424. 3.13e5    316615. 558451. 3.63e6             0  1199575.\n    11 2023-01-01    11424. 3.13e5    311575. 558451. 3.62e6             0  1194704.\n    12 2023-02-01    11424. 2.82e5    271122. 558451. 3.29e6             0  1123459.\n    # ℹ 3 more variables: Income <dbl>, Saving <dbl>, Expense <dbl>\n    ```\n    :::\n    :::\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ggplot(data=highlevel,\n           aes(x=date,\n               y=Income)) +\n      geom_bar(stat=\"identity\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n    :::\n    :::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n\nh<-ggplot(highlevel) +\n  geom_segment( aes(x=date, xend=date, y=Income, yend=Expense), color=\"grey\") +\n  geom_point( aes(x=date, y=Income), color=rgb(0.2,0.7,0.1,0.5), size=3 ) +\n  geom_point( aes(x=date, y=Expense), color=rgb(0.7,0.2,0.1,0.5), size=3 ) +\n  geom_line(aes(x=date, y=Saving), color=rgb(0.2,0.2,0.9,0.5), size=1) +\n  theme_light() +\n  theme(#legend.position = \"none\",\n        #panel.grid.major.y = element_line(color=\"grey\", linetype=\"dashed\"),\n        axis.line.y = element_line(color=\"black\", size=0.5, linetype=\"solid\"),\n        panel.grid.major.x = element_blank(),\n        panel.border = element_blank(),\n        axis.ticks.x = element_blank(),\n        #panel.grid.major = element_line(color = \"grey\", linetype = \"dotted\", size = 0.5),\n        axis.title.x=element_text(angle = 0,\n                                  vjust=0.9),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_x_date(date_breaks = '1 month',date_labels = \"%b %Y\") +\n  scale_y_continuous(limits = c(-2000000, 6500000), breaks=seq(-2000000, 6500000, 1000000), labels= comma) +\n  geom_hline(yintercept=0, color=\"black\", size=0.5)+\n  xlab(\"\") +\n  ylab(\"Amount\")\n\nggplotly(h)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-d158756b27b0450d24ab\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d158756b27b0450d24ab\">{\"x\":{\"data\":[{\"x\":[19052,19052,null,19083,19083,null,19113,19113,null,19144,19144,null,19174,19174,null,19205,19205,null,19236,19236,null,19266,19266,null,19297,19297,null,19327,19327,null,19358,19358,null,19389,19389],\"y\":[6122113.9,-1612753.07,null,3470185.99,-1265312.08,null,3623068.09,-1219825.4,null,3608883.31,-1187570.94,null,3485799.42,-1213284.94,null,3763807.89,-1189655.46,null,3610504.14,-1174641.52,null,3483352.75,-1210151.18,null,3607156.48,-1160991.35,null,3627932.32,-1199574.64,null,3623061.39,-1194704.27,null,3292643.75,-1123458.51],\"text\":[\"date: 2022-03-01<br />Income: 6122114<br />date: 19052<br />Expense: -1612753\",\"date: 2022-03-01<br />Income: 6122114<br />date: 19052<br />Expense: -1612753\",null,\"date: 2022-04-01<br />Income: 3470186<br />date: 19083<br />Expense: -1265312\",\"date: 2022-04-01<br />Income: 3470186<br />date: 19083<br />Expense: -1265312\",null,\"date: 2022-05-01<br />Income: 3623068<br />date: 19113<br />Expense: -1219825\",\"date: 2022-05-01<br />Income: 3623068<br />date: 19113<br />Expense: -1219825\",null,\"date: 2022-06-01<br />Income: 3608883<br />date: 19144<br />Expense: -1187571\",\"date: 2022-06-01<br />Income: 3608883<br />date: 19144<br />Expense: -1187571\",null,\"date: 2022-07-01<br />Income: 3485799<br />date: 19174<br />Expense: -1213285\",\"date: 2022-07-01<br />Income: 3485799<br />date: 19174<br />Expense: -1213285\",null,\"date: 2022-08-01<br />Income: 3763808<br />date: 19205<br />Expense: -1189655\",\"date: 2022-08-01<br />Income: 3763808<br />date: 19205<br />Expense: -1189655\",null,\"date: 2022-09-01<br />Income: 3610504<br />date: 19236<br />Expense: -1174642\",\"date: 2022-09-01<br />Income: 3610504<br />date: 19236<br />Expense: -1174642\",null,\"date: 2022-10-01<br />Income: 3483353<br />date: 19266<br />Expense: -1210151\",\"date: 2022-10-01<br />Income: 3483353<br />date: 19266<br />Expense: -1210151\",null,\"date: 2022-11-01<br />Income: 3607156<br />date: 19297<br />Expense: -1160991\",\"date: 2022-11-01<br />Income: 3607156<br />date: 19297<br />Expense: -1160991\",null,\"date: 2022-12-01<br />Income: 3627932<br />date: 19327<br />Expense: -1199575\",\"date: 2022-12-01<br />Income: 3627932<br />date: 19327<br />Expense: -1199575\",null,\"date: 2023-01-01<br />Income: 3623061<br />date: 19358<br />Expense: -1194704\",\"date: 2023-01-01<br />Income: 3623061<br />date: 19358<br />Expense: -1194704\",null,\"date: 2023-02-01<br />Income: 3292644<br />date: 19389<br />Expense: -1123459\",\"date: 2023-02-01<br />Income: 3292644<br />date: 19389<br />Expense: -1123459\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(190,190,190,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[6122113.9,3470185.99,3623068.09,3608883.31,3485799.42,3763807.89,3610504.14,3483352.75,3607156.48,3627932.32,3623061.39,3292643.75],\"text\":[\"date: 2022-03-01<br />Income: 6122114\",\"date: 2022-04-01<br />Income: 3470186\",\"date: 2022-05-01<br />Income: 3623068\",\"date: 2022-06-01<br />Income: 3608883\",\"date: 2022-07-01<br />Income: 3485799\",\"date: 2022-08-01<br />Income: 3763808\",\"date: 2022-09-01<br />Income: 3610504\",\"date: 2022-10-01<br />Income: 3483353\",\"date: 2022-11-01<br />Income: 3607156\",\"date: 2022-12-01<br />Income: 3627932\",\"date: 2023-01-01<br />Income: 3623061\",\"date: 2023-02-01<br />Income: 3292644\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(51,179,26,0.502)\",\"opacity\":1,\"size\":11.3385826771654,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(51,179,26,0.502)\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[-1612753.07,-1265312.08,-1219825.4,-1187570.94,-1213284.94,-1189655.46,-1174641.52,-1210151.18,-1160991.35,-1199574.64,-1194704.27,-1123458.51],\"text\":[\"date: 2022-03-01<br />Expense: -1612753\",\"date: 2022-04-01<br />Expense: -1265312\",\"date: 2022-05-01<br />Expense: -1219825\",\"date: 2022-06-01<br />Expense: -1187571\",\"date: 2022-07-01<br />Expense: -1213285\",\"date: 2022-08-01<br />Expense: -1189655\",\"date: 2022-09-01<br />Expense: -1174642\",\"date: 2022-10-01<br />Expense: -1210151\",\"date: 2022-11-01<br />Expense: -1160991\",\"date: 2022-12-01<br />Expense: -1199575\",\"date: 2023-01-01<br />Expense: -1194704\",\"date: 2023-02-01<br />Expense: -1123459\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(179,51,26,0.502)\",\"opacity\":1,\"size\":11.3385826771654,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(179,51,26,0.502)\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[4509360.83,2204873.91,2403242.69,2421312.37,2272514.48,2574152.43,2435862.62,2273201.57,2446165.13,2428357.68,2428357.12,2169185.24],\"text\":[\"date: 2022-03-01<br />Saving: 4509361\",\"date: 2022-04-01<br />Saving: 2204874\",\"date: 2022-05-01<br />Saving: 2403243\",\"date: 2022-06-01<br />Saving: 2421312\",\"date: 2022-07-01<br />Saving: 2272514\",\"date: 2022-08-01<br />Saving: 2574152\",\"date: 2022-09-01<br />Saving: 2435863\",\"date: 2022-10-01<br />Saving: 2273202\",\"date: 2022-11-01<br />Saving: 2446165\",\"date: 2022-12-01<br />Saving: 2428358\",\"date: 2023-01-01<br />Saving: 2428357\",\"date: 2023-02-01<br />Saving: 2169185\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":3.77952755905512,\"color\":\"rgba(51,51,230,0.502)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19035.15,19405.85],\"y\":[0,0],\"text\":\"yintercept: 0\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.2283105022831,\"r\":7.30593607305936,\"b\":39.2002401882598,\"l\":84.0182648401827},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19035.15,19405.85],\"tickmode\":\"array\",\"ticktext\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"tickvals\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"categoryorder\":\"array\",\"categoryarray\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2425000,6925000],\"tickmode\":\"array\",\"ticktext\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"tickvals\":[-2000000,-1000000,0,1000000,2000000,3000000,4000000,5000000,6000000],\"categoryorder\":\"array\",\"categoryarray\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.33208800332088,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Amount\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"8c342a7a1f65\":{\"x\":{},\"y\":{},\"xend\":{},\"yend\":{},\"type\":\"scatter\"},\"8c3460633f7c\":{\"x\":{},\"y\":{}},\"8c34453015d8\":{\"x\":{},\"y\":{}},\"8c34117d3f72\":{\"x\":{},\"y\":{}},\"8c347270bdb\":{\"yintercept\":{}}},\"cur_data\":\"8c342a7a1f65\",\"visdat\":{\"8c342a7a1f65\":[\"function (y) \",\"x\"],\"8c3460633f7c\":[\"function (y) \",\"x\"],\"8c34453015d8\":[\"function (y) \",\"x\"],\"8c34117d3f72\":[\"function (y) \",\"x\"],\"8c347270bdb\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\\\n\nrgb colour the first three arguments (red, green, and blue) , the last argument (alpha)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh<-ggplot(highlevel) +\n  geom_segment( aes(x=date, xend=date, y=Income, yend=Expense, color=\"grey20\"), size=0.6, alpha= 0.9) +\n  geom_point( aes(x=date, y=Income, color=\"Income\", shape=\"Income\" , size = Income))+#, size=2 ) +\n  geom_point( aes(x=date, y=Expense, color=\"Expense\", shape=\"Expense\", size = -Expense))+#, size=2 ) +\n  geom_line(aes(x=date, y=Saving), color=rgb(0.2,0.2,0.9,0.9), size=1) +\n  geom_text(aes(x=as.Date(\"2022-04-01\"), y=max(Saving), label=\"Saving\"), hjust=1, vjust=1, color=rgb(0.2,0.2,0.9,0.5), size=3.5) +\n  \n  theme_light() +\n  theme(#legend.position = \"none\",\n        axis.line.y = element_line(color=\"black\", size=0.2, linetype=\"solid\"),\n        panel.grid.major.x = element_blank(),\n        panel.border = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.title.y=element_text(angle = 0,\n                                  vjust=0.9),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_x_date(date_breaks = '1 month',date_labels = \"%b %Y\") +\n  scale_y_continuous(limits = c(-2000000, 6500000), breaks=seq(-2000000, 6500000, 1000000), labels= comma) +\n  \n  scale_color_manual(values = c(\"Income\" = rgb(0.2,0.7,0.1,0.9), \"Expense\" = rgb(0.7,0.2,0.1,0.9))) +\n  scale_shape_manual(values = c(\"Income\" = 16, \"Expense\" = 16)) +\n  labs(color=\"Variable\", shape=\"Variable\") +\n  guides(color = guide_legend(override.aes = list(size = 4))) +\n  \n  geom_hline(yintercept=0, color=\"black\", size=0.2) +\n  \n  xlab(\"\") +\n  ylab(\"Amount\") +\n  ggtitle('City monthly total income, total expense and total savings')\n\nggplotly(h,\n         tooltip = c(\"Income\",\n                     \"Expense\",\n                     \"Saving\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-dd389daefef703c111b4\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-dd389daefef703c111b4\">{\"x\":{\"data\":[{\"x\":[19052,19052,null,19083,19083,null,19113,19113,null,19144,19144,null,19174,19174,null,19205,19205,null,19236,19236,null,19266,19266,null,19297,19297,null,19327,19327,null,19358,19358,null,19389,19389],\"y\":[6122113.9,-1612753.07,null,3470185.99,-1265312.08,null,3623068.09,-1219825.4,null,3608883.31,-1187570.94,null,3485799.42,-1213284.94,null,3763807.89,-1189655.46,null,3610504.14,-1174641.52,null,3483352.75,-1210151.18,null,3607156.48,-1160991.35,null,3627932.32,-1199574.64,null,3623061.39,-1194704.27,null,3292643.75,-1123458.51],\"text\":[\"Income: 6122114<br />Expense: -1612753\",\"Income: 6122114<br />Expense: -1612753\",null,\"Income: 3470186<br />Expense: -1265312\",\"Income: 3470186<br />Expense: -1265312\",null,\"Income: 3623068<br />Expense: -1219825\",\"Income: 3623068<br />Expense: -1219825\",null,\"Income: 3608883<br />Expense: -1187571\",\"Income: 3608883<br />Expense: -1187571\",null,\"Income: 3485799<br />Expense: -1213285\",\"Income: 3485799<br />Expense: -1213285\",null,\"Income: 3763808<br />Expense: -1189655\",\"Income: 3763808<br />Expense: -1189655\",null,\"Income: 3610504<br />Expense: -1174642\",\"Income: 3610504<br />Expense: -1174642\",null,\"Income: 3483353<br />Expense: -1210151\",\"Income: 3483353<br />Expense: -1210151\",null,\"Income: 3607156<br />Expense: -1160991\",\"Income: 3607156<br />Expense: -1160991\",null,\"Income: 3627932<br />Expense: -1199575\",\"Income: 3627932<br />Expense: -1199575\",null,\"Income: 3623061<br />Expense: -1194704\",\"Income: 3623061<br />Expense: -1194704\",null,\"Income: 3292644<br />Expense: -1123459\",\"Income: 3292644<br />Expense: -1123459\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(127,127,127,0.9)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[6122113.9,3470185.99,3623068.09,3608883.31,3485799.42,3763807.89,3610504.14,3483352.75,3607156.48,3627932.32,3623061.39,3292643.75],\"text\":[\"Income: 6122114<br />Income: 6122114\",\"Income: 3470186<br />Income: 3470186\",\"Income: 3623068<br />Income: 3623068\",\"Income: 3608883<br />Income: 3608883\",\"Income: 3485799<br />Income: 3485799\",\"Income: 3763808<br />Income: 3763808\",\"Income: 3610504<br />Income: 3610504\",\"Income: 3483353<br />Income: 3483353\",\"Income: 3607156<br />Income: 3607156\",\"Income: 3627932<br />Income: 3627932\",\"Income: 3623061<br />Income: 3623061\",\"Income: 3292644<br />Income: 3292644\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(51,179,26,0.902)\",\"opacity\":1,\"size\":[22.6771653543307,16.7278126078653,17.1429289198985,17.1049576703205,16.770815468108,17.5139885787233,17.1093019451494,16.7640862046622,17.1003277272347,17.1559251624572,17.1429110101317,16.2283778003363],\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(51,179,26,0.902)\"}},\"hoveron\":\"points\",\"name\":\"Income\",\"legendgroup\":\"Income\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[-1612753.07,-1265312.08,-1219825.4,-1187570.94,-1213284.94,-1189655.46,-1174641.52,-1210151.18,-1160991.35,-1199574.64,-1194704.27,-1123458.51],\"text\":[\"Expense: -1612753\",\"Expense: -1265312\",\"Expense: -1219825\",\"Expense: -1187571\",\"Expense: -1213285\",\"Expense: -1189655\",\"Expense: -1174642\",\"Expense: -1210151\",\"Expense: -1160991\",\"Expense: -1199575\",\"Expense: -1194704\",\"Expense: -1123459\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(179,51,26,0.902)\",\"opacity\":1,\"size\":[9.69195897202369,6.96299972571424,6.40341284320808,5.91971613273669,6.31280637814119,5.95423035125546,5.69177387711998,6.26822505882851,5.41704764518651,6.11147775959389,6.03563840790087,3.77952755905512],\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(179,51,26,0.902)\"}},\"hoveron\":\"points\",\"name\":\"Expense\",\"legendgroup\":\"Expense\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[4509360.83,2204873.91,2403242.69,2421312.37,2272514.48,2574152.43,2435862.62,2273201.57,2446165.13,2428357.68,2428357.12,2169185.24],\"text\":[\"Saving: 4509361\",\"Saving: 2204874\",\"Saving: 2403243\",\"Saving: 2421312\",\"Saving: 2272514\",\"Saving: 2574152\",\"Saving: 2435863\",\"Saving: 2273202\",\"Saving: 2446165\",\"Saving: 2428358\",\"Saving: 2428357\",\"Saving: 2169185\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":3.77952755905512,\"color\":\"rgba(51,51,230,0.902)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083],\"y\":[4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83],\"text\":[\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\"],\"hovertext\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],\"textfont\":{\"size\":13.2283464566929,\"color\":\"rgba(51,51,230,0.502)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19035.15,19405.85],\"y\":[0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":0.755905511811024,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.7625570776256,\"r\":7.30593607305936,\"b\":39.2002401882598,\"l\":113.24200913242},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"title\":{\"text\":\"City monthly total income, total expense and total savings\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.5342465753425},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19035.15,19405.85],\"tickmode\":\"array\",\"ticktext\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"tickvals\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"categoryorder\":\"array\",\"categoryarray\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2425000,6925000],\"tickmode\":\"array\",\"ticktext\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"tickvals\":[-2000000,-1000000,0,1000000,2000000,3000000,4000000,5000000,6000000],\"categoryorder\":\"array\",\"categoryarray\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.33208800332088,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.265670402656704,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Amount\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"Income<br />Variable\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"8c347fca2f72\":{\"x\":{},\"y\":{},\"xend\":{},\"yend\":{},\"colour\":{},\"type\":\"scatter\"},\"8c3471557f4c\":{\"x\":{},\"y\":{},\"colour\":{},\"shape\":{},\"size\":{}},\"8c342a7442fc\":{\"x\":{},\"y\":{},\"colour\":{},\"shape\":{},\"size\":{}},\"8c341a1f23b6\":{\"x\":{},\"y\":{}},\"8c347de57cc5\":{\"x\":{},\"y\":{},\"label\":{}},\"8c342d474f3b\":{\"yintercept\":{}}},\"cur_data\":\"8c347fca2f72\",\"visdat\":{\"8c347fca2f72\":[\"function (y) \",\"x\"],\"8c3471557f4c\":[\"function (y) \",\"x\"],\"8c342a7442fc\":[\"function (y) \",\"x\"],\"8c341a1f23b6\":[\"function (y) \",\"x\"],\"8c347de57cc5\":[\"function (y) \",\"x\"],\"8c342d474f3b\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}