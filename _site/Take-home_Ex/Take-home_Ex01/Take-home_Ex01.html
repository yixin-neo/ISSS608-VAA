<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="NeoYX">
<meta name="dcterms.date" content="2023-05-07">

<title>NYX VA - Take-home_Ex01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">NYX VA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Take-home_Ex01</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Hands-on Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">Hands-on_Ex02</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">Hands-on_Ex03</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" class="sidebar-item-text sidebar-link">Hands-on_Ex04</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">Hands-on_Ex05</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">Hands-on_Ex06</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" class="sidebar-item-text sidebar-link">Hands-on_Ex07</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">In-class Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" class="sidebar-item-text sidebar-link">In-class_Ex01</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" class="sidebar-item-text sidebar-link">In-class_Ex03</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" class="sidebar-item-text sidebar-link">In-class_Ex04</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Take-home Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" class="sidebar-item-text sidebar-link active">Take-home_Ex01</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#task-and-dataset" id="toc-task-and-dataset" class="nav-link active" data-scroll-target="#task-and-dataset">1. Task and Dataset</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#install-and-load-the-required-libraries" id="toc-install-and-load-the-required-libraries" class="nav-link" data-scroll-target="#install-and-load-the-required-libraries">2.1 Install and load the required libraries</a></li>
  <li><a href="#import-the-dataset" id="toc-import-the-dataset" class="nav-link" data-scroll-target="#import-the-dataset">2.2 Import the dataset</a></li>
  <li><a href="#data-issues-and-wrangling" id="toc-data-issues-and-wrangling" class="nav-link" data-scroll-target="#data-issues-and-wrangling">2.3 Data Issues and wrangling</a>
  <ul class="collapse">
  <li><a href="#finance-dataset-issues" id="toc-finance-dataset-issues" class="nav-link" data-scroll-target="#finance-dataset-issues">2.3.1 <strong>finance</strong> dataset issues:</a></li>
  <li><a href="#ptcp-dataset-issues" id="toc-ptcp-dataset-issues" class="nav-link" data-scroll-target="#ptcp-dataset-issues">2.3.2 ptcp dataset issues:</a></li>
  <li><a href="#convert-finance1-table-to-wide-format-and-perform-left-outer-join-with-ptcp1-table." id="toc-convert-finance1-table-to-wide-format-and-perform-left-outer-join-with-ptcp1-table." class="nav-link" data-scroll-target="#convert-finance1-table-to-wide-format-and-perform-left-outer-join-with-ptcp1-table.">2.3.3 Convert <code>finance1</code> table to wide format and perform left outer join with <code>ptcp1</code> table.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">3 Visualisation</a>
  <ul class="collapse">
  <li><a href="#wage-and-categories-of-expenses" id="toc-wage-and-categories-of-expenses" class="nav-link" data-scroll-target="#wage-and-categories-of-expenses">3.1 Wage and categories of expenses</a></li>
  <li><a href="#normality-assumptions-of-annual-wage" id="toc-normality-assumptions-of-annual-wage" class="nav-link" data-scroll-target="#normality-assumptions-of-annual-wage">3.2.1 Normality assumptions of annual wage</a>
  <ul class="collapse">
  <li><a href="#interactive-line-charts-of-wages-by-month" id="toc-interactive-line-charts-of-wages-by-month" class="nav-link" data-scroll-target="#interactive-line-charts-of-wages-by-month">3.1.2 Interactive Line charts of wages by month</a></li>
  <li><a href="#next-plot-interactive-pending-coordinated-line-chart-of-expenditures-by-month" id="toc-next-plot-interactive-pending-coordinated-line-chart-of-expenditures-by-month" class="nav-link" data-scroll-target="#next-plot-interactive-pending-coordinated-line-chart-of-expenditures-by-month">Next Plot: Interactive (pending coordinated) Line chart of expenditures by month</a></li>
  <li><a href="#interactive-heatmap-of-annual-recreation-spending-and-joviality-index" id="toc-interactive-heatmap-of-annual-recreation-spending-and-joviality-index" class="nav-link" data-scroll-target="#interactive-heatmap-of-annual-recreation-spending-and-joviality-index">3.1.3 Interactive Heatmap of annual recreation spending and joviality index</a></li>
  </ul></li>
  <li><a href="#cda" id="toc-cda" class="nav-link" data-scroll-target="#cda">3.2 CDA</a>
  <ul class="collapse">
  <li><a href="#one-way-anova-plots-to-compare-wagerecreationjoviality-across-education-levels" id="toc-one-way-anova-plots-to-compare-wagerecreationjoviality-across-education-levels" class="nav-link" data-scroll-target="#one-way-anova-plots-to-compare-wagerecreationjoviality-across-education-levels">3.2.2 One-way Anova plots to compare Wage/Recreation/Joviality across Education levels</a></li>
  <li><a href="#correlation-between-annual-shelter-cost-and-annual-wage" id="toc-correlation-between-annual-shelter-cost-and-annual-wage" class="nav-link" data-scroll-target="#correlation-between-annual-shelter-cost-and-annual-wage">3.2.3 Correlation between Annual Shelter cost and Annual Wage</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">4 References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Take-home_Ex01</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>NeoYX </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 7, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="task-and-dataset" class="level1">
<h1>1. Task and Dataset</h1>
<p>This exerise aims to reveal the demographic and financial characteristics of the city of Engagement, using appropriate <strong>static and interactive statistical graphics</strong> methods. It also requires a user-friendly and interactive solution that helps city managers and planners to explore the complex data in an engaging way and reveal hidden patterns.</p>
<p>The dataset consists of a sample <strong>survey</strong> of 1000 representative residents that collects data related to their household demographic and spending patterns, among other things. There are primarily two datasets used in this exercise</p>
<ul>
<li><p>’FinancialJournal.csv”: Contains 1513635 number of daily transaction records (different categories of income and expenses) over a period of twelve months from March 2022 to February 2023.</p></li>
<li><p>’Particpants.csv” : Contains demographics information like household size, age, education level, interest groups, joviality index and whether each household has kids.</p></li>
</ul>
<p>In this exercise, each dataset will be cleansed separately and then joined by ‘participantID’ as primary key to form the final dataset used for further analysis.</p>
</section>
<section id="section" class="level1">
<h1></h1>
</section>
<section id="data-preparation" class="level1">
<h1>2. Data Preparation</h1>
<section id="install-and-load-the-required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="install-and-load-the-required-libraries">2.1 Install and load the required libraries</h2>
<p>The code chunk below uses <code>pacman::p_load()</code> to check if packages are installed. If they are, they will be launched into R. The packages installed are</p>
<ul>
<li><p><code>plotly</code>: Used for creating interactive web-based graphs.</p></li>
<li><p><code>knitr</code>: Used for dynamic report generation</p></li>
<li><p><code>patchwork</code>: Used to combine plots</p></li>
<li><p><code>tidyverse</code>: A collection of core packages designed for data science, used extensively for data preparation and wrangling.</p></li>
<li><p><code>ggthemes</code>: Provide additional themes for <code>ggplot2</code></p></li>
<li><p><code>ggstatsplot</code>: Used for creating graphics with details from statistical tests.</p></li>
<li><p><code>ggdist</code>: Used for visualising distribution and uncertainty</p></li>
<li><p><code>rstatix</code>: Allows us to perform basic statistical tests, including t-test, Wilcoxon test, ANOVA, Kruskal-Wallis and correlation analyses.</p></li>
<li><p><code>gt</code> : starting from a tibble table, customise a table and export in various formats. Most importantly, it works with patch. We will save the tabular results from shapiro test as gt object and export using gtsave() into .png file later.</p></li>
<li></li>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(plotly, knitr, patchwork, tidyverse, ggthemes,hrbrthemes, ggiraph, ggstatsplot, ggdist, png, gifski, rstatix, gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="import-the-dataset">2.2 Import the dataset</h2>
<p>The datasets are imported using <code>tidyverse</code>’s <code>readr::read_csv()</code> function.</p>
<p>’FinancialJournal.csv” is stored as <code>finance</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>finance <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/FinancialJournal.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  participantId timestamp           category  amount
          &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;      &lt;dbl&gt;
1             0 2022-03-01 00:00:00 Wage      2473. 
2             0 2022-03-01 00:00:00 Shelter   -555. 
3             0 2022-03-01 00:00:00 Education  -38.0
4             1 2022-03-01 00:00:00 Wage      2047. 
5             1 2022-03-01 00:00:00 Shelter   -555. 
6             1 2022-03-01 00:00:00 Education  -38.0</code></pre>
</div>
</div>
<p>Check for empty values in the <code>finance</code> table using the <code>is.na()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(finance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>’Particpants.csv” is stored as <code>ptcp</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ptcp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Participants.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  participantId householdSize haveKids   age educationLevel      interestGroup
          &lt;dbl&gt;         &lt;dbl&gt; &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;        
1             0             3 TRUE        36 HighSchoolOrCollege H            
2             1             3 TRUE        25 HighSchoolOrCollege B            
3             2             3 TRUE        35 HighSchoolOrCollege A            
4             3             3 TRUE        21 HighSchoolOrCollege I            
5             4             3 TRUE        43 Bachelors           H            
6             5             3 TRUE        32 HighSchoolOrCollege D            
# ℹ 1 more variable: joviality &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Checking for empty values in <code>ptcp</code> table using the <code>is.na()</code>` function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(ptcp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="data-issues-and-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-issues-and-wrangling">2.3 Data Issues and wrangling</h2>
<p>I will discuss the issues in the datasets and proposed cleaning methods.</p>
<section id="finance-dataset-issues" class="level3">
<h3 class="anchored" data-anchor-id="finance-dataset-issues">2.3.1 <strong>finance</strong> dataset issues:</h3>
<ul>
<li><p><strong>participantId</strong> should be converted from <code>&lt;dbl&gt;</code> format to <code>&lt;chr&gt;</code> format. It should be a categorical and not numerical data type.</p></li>
<li><p><strong>timestamp</strong> should be converted from <code>&lt;dttm&gt;</code> format to <code>&lt;date&gt;</code> format as I will not be analysing time in this exercise.</p></li>
<li><p>Negative values of <strong>amount</strong> that belong to the expenses categories should be converted to positive values. The amount will also be rounded to two decimal places.</p></li>
</ul>
<p>The code chunk below does the following:</p>
<ul>
<li><p>use the <strong><code>as.character()</code></strong> function to convert <strong>participantId</strong> to <code>&lt;chr&gt;</code> format</p></li>
<li><p>create a new column <strong>month_year</strong> by extracting the year and month from the <strong>timestamp</strong> column using the <strong><code>format()</code></strong> function with the <strong><code>%Y-%m</code></strong> format specifier.</p></li>
<li><p>use the <strong><code>abs()</code></strong> function to convert negative values <strong>amount</strong> to positive and round the values to 2 decimal places using the <strong><code>round()</code></strong> function.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert participantId to character</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>finance <span class="ot">&lt;-</span> finance <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">participantId =</span> <span class="fu">as.character</span>(participantId))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract month and year from timestamp</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>finance <span class="ot">&lt;-</span> finance <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_year =</span> <span class="fu">format</span>(timestamp, <span class="st">"%m-%Y"</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform negative amounts to positive and round to 2 decimal places</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>finance <span class="ot">&lt;-</span> finance <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">amount =</span> <span class="fu">abs</span>(amount),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">amount =</span> <span class="fu">round</span>(amount, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A check for duplicates using the <code>duplicated()</code> function reveals that there are 1,113 records of duplicates.</p>
<ul>
<li>The <strong><code>duplicated()</code></strong> function to identify the duplicate rows. It returns a logical vector indicating whether each row is a duplicate of a previous row in the data frame. We can then use this logical vector to subset the data frame and show the duplicate rows. The logical vector is stored in a filter <strong>duplicated_rows</strong> which is used to subset the <code>finance</code> data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate rows</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>duplicated_rows <span class="ot">&lt;-</span> finance[<span class="fu">duplicated</span>(finance),]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicated_rows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,113
Columns: 5
$ participantId &lt;chr&gt; "0", "0", "1", "1", "2", "2", "3", "3", "4", "4", "5", "…
$ timestamp     &lt;dttm&gt; 2022-03-01, 2022-03-01, 2022-03-01, 2022-03-01, 2022-03…
$ category      &lt;chr&gt; "Shelter", "Education", "Shelter", "Education", "Shelter…
$ amount        &lt;dbl&gt; 554.99, 38.01, 554.99, 38.01, 556.55, 12.81, 554.99, 38.…
$ month_year    &lt;chr&gt; "03-2022", "03-2022", "03-2022", "03-2022", "03-2022", "…</code></pre>
</div>
</div>
<ul>
<li><strong><code>unique()</code></strong> function is used to remove the duplicate rows form <code>finance</code> data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicate rows</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>finance <span class="ot">&lt;-</span> <span class="fu">unique</span>(finance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Perform a final check to verify that there are no more duplicate using <code>any()</code> function</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(finance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>The last thing to do is to create a new column <strong>date</strong> that is in <code>&lt;date&gt;</code> format using the <code>as.Date</code> function.</p>
<ul>
<li><p>the paste0() function is used to concatenate “01-” with each value in the month_year column. This is because as.Date() requires a complete date in the format “dd-mm-yyyy”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>finance<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"01-"</span>, finance<span class="sc">$</span>month_year), <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
<p><strong>Other issues</strong></p>
<p>When the <code>finance</code> dataset is group-by the <strong>date</strong> variable , it is noticed that the number of distinct participantID who took part in the survey was 1,011 in March 2022 and suddenly reduced to a constant value of 880 from April 2022 onwards. It seems to suggest that there are 131 residents who moved out of the city at the end of March 2022.</p>
<p>In the code chunk below:</p>
<ul>
<li><p>dataset is group-by <strong>date</strong> and the distinct count of <strong>participantID</strong> is generated using <code>n_distinct</code> function</p></li>
<li><p>the <strong>missing</strong> dataframe is displayed below using <code>knitr::kable()</code> function</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="ot">&lt;-</span> finance <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_distinct=</span><span class="fu">n_distinct</span>(participantId)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Number of unique participantId</span><span class="st">`</span> <span class="ot">=</span> n_distinct)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(missing_summary, <span class="st">"simple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: right;">Number of unique participantId</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2022-03-01</td>
<td style="text-align: right;">1011</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-04-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-05-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-06-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-07-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-08-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-09-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-10-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-11-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-12-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">880</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-02-01</td>
<td style="text-align: right;">880</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Since 11 out of 12 months of records are missing for these 131 residents, we will delete their records from the <code>finance</code> dataset.</p>
<p>The code chunk below does the following:</p>
<ul>
<li><p>extract the <strong>participantIds</strong> of residents whose records exists in March 22 but not in all April 22 using the <code>anti-join</code> function</p></li>
<li><p>pass the unique <strong><code>participantId</code></strong> column name as an argument to <strong><code>pull()</code></strong> and use the <strong><code>as.vector()</code></strong> function to convert the resulting tibble column to a vector</p></li>
<li><p>resulting dataframe will only contain <strong><code>participantId</code></strong>s that are in ‘2022-03-01’ but not in ‘2022-04-01’ onwards. There are 131 of them.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>missing_id <span class="ot">&lt;-</span> finance <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">'2022-03-01'</span>)) <span class="sc">%&gt;%</span> <span class="co"># filter for '2022-03-01' date</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(finance <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">'2022-04-01'</span>)), <span class="co"># filter for '2022-04-01' date</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="st">'participantId'</span>) <span class="sc">%&gt;%</span> <span class="co"># anti-join by 'participantId'</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participantId) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participantId)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extract participantId column as convert this column to vector.</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>missing_id_vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">pull</span>(missing_id, participantId))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>missing_id_vector </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "44"  "127" "142" "154" "161" "256" "262" "267" "279" "285" "288" "298"
 [13] "301" "346" "352" "356" "380" "382" "383" "384" "392" "406" "407" "509"
 [25] "510" "512" "514" "523" "526" "539" "541" "553" "558" "567" "568" "572"
 [37] "574" "575" "577" "580" "589" "595" "599" "602" "603" "604" "605" "611"
 [49] "615" "617" "621" "628" "629" "634" "639" "641" "643" "647" "653" "655"
 [61] "657" "658" "663" "668" "670" "756" "757" "760" "761" "762" "768" "771"
 [73] "773" "774" "780" "785" "789" "790" "791" "792" "793" "794" "799" "802"
 [85] "806" "808" "816" "817" "818" "824" "825" "827" "828" "831" "832" "834"
 [97] "839" "842" "846" "847" "853" "855" "856" "858" "859" "860" "862" "864"
[109] "867" "872" "875" "876" "883" "884" "885" "886" "887" "892" "896" "897"
[121] "900" "901" "902" "907" "909" "911" "919" "920" "923" "924" "925"</code></pre>
</div>
</div>
<p>Next, we will remove all records of the 131 potentially non-residents from the <code>finance</code> dataset .</p>
<p>In the code chunk below:</p>
<ul>
<li><p>the <strong><code>%in%</code></strong> operator is to check if each <strong><code>id</code></strong> value is contained in the missing_id_vector</p></li>
<li><p>the negation operator <strong><code>!</code></strong> ensures the resulting filtered data frame will not contain the rows where the <strong><code>id</code></strong> values are in missing_id_vector</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>finance1 <span class="ot">&lt;-</span> finance[<span class="sc">!</span>finance<span class="sc">$</span>participantId <span class="sc">%in%</span> missing_id_vector, ]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>finance1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,509,897 × 6
   participantId timestamp           category  amount month_year date      
   &lt;chr&gt;         &lt;dttm&gt;              &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;date&gt;    
 1 0             2022-03-01 00:00:00 Wage      2473.  03-2022    2022-03-01
 2 0             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01
 3 0             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01
 4 1             2022-03-01 00:00:00 Wage      2047.  03-2022    2022-03-01
 5 1             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01
 6 1             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01
 7 2             2022-03-01 00:00:00 Wage      2437.  03-2022    2022-03-01
 8 2             2022-03-01 00:00:00 Shelter    557.  03-2022    2022-03-01
 9 2             2022-03-01 00:00:00 Education   12.8 03-2022    2022-03-01
10 3             2022-03-01 00:00:00 Wage      2367.  03-2022    2022-03-01
# ℹ 1,509,887 more rows</code></pre>
</div>
</div>
<p>We will double check that the records of 131 non-residents have been removed from <code>finance1</code> dataframe.</p>
<p>In the code below</p>
<ul>
<li><p><strong><code>distinct()</code></strong> function to extract the distinct <strong><code>participantId</code></strong> values from <strong><code>finance1</code></strong></p></li>
<li><p>the <strong><code>n_distinct()</code></strong> function will count the number of distinct <strong><code>participantId</code></strong> values in the resulting tibble</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>finance1 <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participantId) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 880</code></pre>
</div>
</div>
</section>
<section id="ptcp-dataset-issues" class="level3">
<h3 class="anchored" data-anchor-id="ptcp-dataset-issues">2.3.2 ptcp dataset issues:</h3>
<ul>
<li><p><strong>participantId</strong> should be converted from <code>&lt;dbl&gt;</code> format to <code>&lt;chr&gt;</code> format</p></li>
<li><p><strong>householdSize</strong> should be converted from <code style="caret-color: white;">&lt;dbl&gt;</code> format to <code style="caret-color: white;">&lt;fct&gt;</code> format. It does not make sense to have 2.5 persons.</p></li>
<li><p><strong>age</strong> should be converted from <code style="caret-color: white;">&lt;dbl&gt;</code> format to <code style="caret-color: white;">&lt;int&gt;</code> format.</p></li>
<li><p><strong>educationLevel</strong> should be converted from <code>&lt;chr&gt;</code> to <code>&lt;fct&gt;</code> . It should also be ordered according to ‘Low’, ‘HighSchoolOrCollege’, ‘Bachelors’ and ‘Graduate’.</p></li>
</ul>
<p>The code chunk below does the following:</p>
<ul>
<li><p><code>as.character</code> and <code>as.factor</code> functions are used to convert <strong>participantId</strong> to <code>&lt;chr&gt;</code> , <strong>householdSize</strong> to <code>&lt;fct&gt;</code> and <strong>age</strong> to <code>&lt;int&gt;</code>.</p></li>
<li><p><code>factor(educationLevel, levels=c("Low", "HighSchoolOrCollege", "Bachelors", "Graduate")))</code> not only converts <strong>educationLevel</strong> to factor, but also order the values inside.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to factor</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ptcp <span class="ot">&lt;-</span> ptcp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">participantId =</span> <span class="fu">as.character</span>(participantId))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ptcp <span class="ot">&lt;-</span> ptcp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">householdSize =</span> <span class="fu">as.factor</span>(householdSize))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert educationLevel to factor and order accordingly</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>ptcp <span class="ot">&lt;-</span> ptcp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">educationLevel =</span> <span class="fu">factor</span>(educationLevel, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"HighSchoolOrCollege"</span>, <span class="st">"Bachelors"</span>, <span class="st">"Graduate"</span>)))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert age to int</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ptcp <span class="ot">&lt;-</span> ptcp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.integer</span>(age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The columns format are all in order now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ptcp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,011
Columns: 7
$ participantId  &lt;chr&gt; "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10",…
$ householdSize  &lt;fct&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…
$ haveKids       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…
$ age            &lt;int&gt; 36, 25, 35, 21, 43, 32, 26, 27, 20, 35, 48, 27, 34, 18,…
$ educationLevel &lt;fct&gt; HighSchoolOrCollege, HighSchoolOrCollege, HighSchoolOrC…
$ interestGroup  &lt;chr&gt; "H", "B", "A", "I", "H", "D", "I", "A", "G", "D", "D", …
$ joviality      &lt;dbl&gt; 0.001626703, 0.328086500, 0.393469590, 0.138063446, 0.8…</code></pre>
</div>
</div>
<p>Use <code>distinct()</code> and <code>n_distinct()</code> to check on the number of unique participantIds in <code>ptcp</code> table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ptcp <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participantId) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1011</code></pre>
</div>
</div>
<p>Currently, the <code>ptcp</code> table still contain the demographic records of the 131 residents who moved out. Let us remove their records by using similar method used in removing the same records in <code>financial</code> table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ptcp1 <span class="ot">&lt;-</span> ptcp[<span class="sc">!</span>ptcp<span class="sc">$</span>participantId <span class="sc">%in%</span> missing_id_vector, ]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ptcp1 <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participantId) <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 880</code></pre>
</div>
</div>
<p>Both <code>finance1</code> and <code>ptcp1</code> tables now contains information about the same number of participantIds.</p>
</section>
<section id="convert-finance1-table-to-wide-format-and-perform-left-outer-join-with-ptcp1-table." class="level3">
<h3 class="anchored" data-anchor-id="convert-finance1-table-to-wide-format-and-perform-left-outer-join-with-ptcp1-table.">2.3.3 Convert <code>finance1</code> table to wide format and perform left outer join with <code>ptcp1</code> table.</h3>
<p>We will now convert the <code>finance1</code> dataframe from a long to a wide format. The code chunk below does the following:</p>
<ul>
<li><p>group the data by <strong>participantId</strong> , <strong>date</strong> and <strong>category</strong> using the <strong><code>group_by</code></strong> function</p></li>
<li><p>use the <code>sum</code> function to calculate the total monthly amount for each <strong>category</strong> per <strong>participantId</strong> per <strong>month</strong></p></li>
<li><p>the <code>pivot_wider</code> function will convert the <strong>category</strong> column to wide format with total monthly values in the <strong>amount</strong> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>finance1_wide<span class="ot">&lt;-</span> finance1 <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participantId, date, category) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_amount =</span> <span class="fu">sum</span>(amount)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> category, <span class="at">values_from =</span> total_amount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,560 × 8
# Groups:   participantId, date [10,560]
   participantId date       Education  Food Recreation Shelter   Wage
   &lt;chr&gt;         &lt;date&gt;         &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 0             2022-03-01      38.0  268.      349.     555. 11932.
 2 0             2022-04-01      38.0  266.      219.     555.  8637.
 3 0             2022-05-01      38.0  265.      383.     555.  9048.
 4 0             2022-06-01      38.0  257.      466.     555.  9048.
 5 0             2022-07-01      38.0  270.     1069.     555.  8637.
 6 0             2022-08-01      38.0  262.      314.     555.  9459.
 7 0             2022-09-01      38.0  256.      295.     555.  9048.
 8 0             2022-10-01      38.0  267.       25.0    555.  8637.
 9 0             2022-11-01      38.0  261       377.     555.  9048.
10 0             2022-12-01      38.0  266.      357.     555.  9048.
# ℹ 10,550 more rows
# ℹ 1 more variable: RentAdjustment &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>About finance1_wide table</p>
<p><code>finance_wide</code> is a table that has one row for each unique combination of <strong>participantId</strong> and <strong>month</strong> and one column for each unique category from the former <code>finance1</code> table.</p>
</div>
</div>
<p>The code chunk below performs a left outer join with finance1_wide table (left) and ptcp1 table (right) with join key <strong>participantId</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left outer join</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>finance1_wide_ptcp1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(finance1_wide, ptcp1, <span class="at">by =</span> <span class="st">"participantId"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first 12 rows of the cleansed finance1_wide_ptcp1 is displayed using <code style="caret-color: white;">knitr::kable()</code> function. It contains 10,560 rows and 14 columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(finance1_wide_ptcp1,<span class="dv">12</span>), <span class="st">"simple"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">participantId</th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">Education</th>
<th style="text-align: right;">Food</th>
<th style="text-align: right;">Recreation</th>
<th style="text-align: right;">Shelter</th>
<th style="text-align: right;">Wage</th>
<th style="text-align: right;">RentAdjustment</th>
<th style="text-align: left;">householdSize</th>
<th style="text-align: left;">haveKids</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">educationLevel</th>
<th style="text-align: left;">interestGroup</th>
<th style="text-align: right;">joviality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-03-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">268.26</td>
<td style="text-align: right;">348.68</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">11931.95</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-04-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">265.79</td>
<td style="text-align: right;">219.42</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">8636.88</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-05-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">264.54</td>
<td style="text-align: right;">382.99</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-06-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">256.90</td>
<td style="text-align: right;">465.67</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-07-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">270.13</td>
<td style="text-align: right;">1069.48</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">8636.88</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-08-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">261.76</td>
<td style="text-align: right;">314.13</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9459.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-09-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">256.04</td>
<td style="text-align: right;">294.64</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-10-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">266.67</td>
<td style="text-align: right;">25.01</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">8636.88</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-11-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">261.00</td>
<td style="text-align: right;">377.41</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2022-12-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">265.98</td>
<td style="text-align: right;">356.69</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">264.97</td>
<td style="text-align: right;">209.77</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">9048.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2023-02-01</td>
<td style="text-align: right;">38.01</td>
<td style="text-align: right;">239.05</td>
<td style="text-align: right;">319.93</td>
<td style="text-align: right;">554.99</td>
<td style="text-align: right;">8225.60</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">HighSchoolOrCollege</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">0.0016267</td>
</tr>
</tbody>
</table>
</div>
</div></li>
</ul>
</section>
</section>
</section>
<section id="visualisation" class="level1">
<h1>3 Visualisation</h1>
<section id="wage-and-categories-of-expenses" class="level2">
<h2 class="anchored" data-anchor-id="wage-and-categories-of-expenses">3.1 Wage and categories of expenses</h2>
<p>In this section, I will explore the dataset from high level and then zoom into interesting patterns (if I can find any =))</p>
</section>
<section id="normality-assumptions-of-annual-wage" class="level2">
<h2 class="anchored" data-anchor-id="normality-assumptions-of-annual-wage">3.2.1 Normality assumptions of annual wage</h2>
<p>Before zooming into wages in March, we will first perform a test to confirm whether wage follows the normal distribution.</p>
<p>H0: The wage does not follow a normal distribution.</p>
<p>H1: The wage follows a normal distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sample_5000<span class="ot">&lt;-</span> finance1_wide_ptcp1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(finance1_wide_ptcp1), <span class="dv">5000</span>), ] <span class="co"># perform sampling as limit of shapiro test is 5000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sample_5000,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample=</span>Wage)) <span class="sc">+</span>  <span class="co">#&lt;&lt;&lt; use a new argument call sample: el scores</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"QQ plot with Shapiro-Wilk test results"</span>)  <span class="co"># add plot title</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>sw_t <span class="ot">&lt;-</span> <span class="fu">shapiro_test</span>(sample_5000<span class="sc">$</span>Wage) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Wage"</span>)<span class="sc">%&gt;%</span> <span class="fu">gt</span>()  <span class="co">#&lt;&lt;&lt; make into a gt format (will give a nice table)  shapiro.test is not used here as it gives output in another format.</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">'.png'</span>) <span class="co"># create  temp table</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gtsave</span>(sw_t, tmp)  <span class="co"># use gtsave() to save sw_t into tmp folder</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>table_png <span class="ot">&lt;-</span> png<span class="sc">::</span><span class="fu">readPNG</span>(tmp, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>qq<span class="sc">+</span>table_png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the Shapiro test , p-value &lt; 0.05 and we have enough statistical evidence to reject the null hypothesis and conclude that Wage does not follow the normal distribution.</p>
<section id="interactive-line-charts-of-wages-by-month" class="level3">
<h3 class="anchored" data-anchor-id="interactive-line-charts-of-wages-by-month">3.1.2 Interactive Line charts of wages by month</h3>
<p>Preparing the data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>highlevel <span class="ot">&lt;-</span> finance1_wide_ptcp1 <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Education =</span> <span class="fu">sum</span>(Education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Food =</span> <span class="fu">sum</span>(Food, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Recreation =</span> <span class="fu">sum</span>(Recreation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Shelter =</span> <span class="fu">sum</span>(Shelter, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Wage =</span> <span class="fu">sum</span>(Wage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">RentAdjustment =</span> <span class="fu">sum</span>(RentAdjustment, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">ExpenseP =</span> <span class="fu">sum</span>(Education, Food, Recreation, Shelter),  <span class="co">#&lt;&lt;&lt;</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">Income =</span> <span class="fu">sum</span>(Wage, RentAdjustment),                    <span class="co">#&lt;&lt;&lt;</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">Saving =</span> Income <span class="sc">-</span> ExpenseP,                            <span class="co">#&lt;&lt;&lt;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">Expense =</span> ExpenseP <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>                                <span class="co">#&lt;&lt;&lt;</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(highlevel,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
  date       Education    Food Recreation Shelter   Wage RentAdjustment ExpenseP
  &lt;date&gt;         &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;
1 2022-03-01    11424. 320126.    649580. 631623. 6.07e6         53504. 1612753.
2 2022-04-01    11424. 304282.    389688. 559919. 3.47e6          1429. 1265312.
3 2022-05-01    11424. 313538.    336413. 558451. 3.62e6             0  1219825.
4 2022-06-01    11424. 302893.    314804. 558451. 3.61e6             0  1187571.
5 2022-07-01    11424. 313803.    329608. 558451. 3.49e6             0  1213285.
# ℹ 3 more variables: Income &lt;dbl&gt;, Saving &lt;dbl&gt;, Expense &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>q1<span class="ot">&lt;-</span>highlevel <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date)) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Wage, <span class="at">color =</span> <span class="st">"Red"</span>, <span class="at">linetype =</span> <span class="st">"Wage"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotating the plot</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.Date</span>(<span class="st">"2022-04-01"</span>),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span><span class="dv">6000000</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span><span class="st">"High wages </span><span class="sc">\n</span><span class="st">observed in </span><span class="sc">\n</span><span class="st">March"</span>), </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">'black'</span>, <span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.Date</span>(<span class="st">"2022-12-01"</span>), <span class="at">y=</span><span class="dv">3800000</span>, <span class="at">label=</span><span class="st">"Wage"</span>),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">vjust=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">'red'</span>, <span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale control</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Amount"</span>) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">'1 month'</span>,<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6500000</span>), <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6500000</span>, <span class="dv">1000000</span>),</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span> , <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">'black'</span>),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">'Cumulative Income across Months'</span>,</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'Month'</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">'Amount'</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(q1,<span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">'labels'</span>,<span class="st">'x'</span>,<span class="st">'y'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f10d14aaab4c6eec5ea0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f10d14aaab4c6eec5ea0">{"x":{"data":[{"x":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],"y":[6068610.35,3468756.75,3623068.09,3608883.31,3485799.42,3763807.89,3610504.14,3483352.75,3607156.48,3627932.32,3623061.39,3292643.75],"text":["date: 2022-03-01<br />Wage: 6068610","date: 2022-04-01<br />Wage: 3468757","date: 2022-05-01<br />Wage: 3623068","date: 2022-06-01<br />Wage: 3608883","date: 2022-07-01<br />Wage: 3485799","date: 2022-08-01<br />Wage: 3763808","date: 2022-09-01<br />Wage: 3610504","date: 2022-10-01<br />Wage: 3483353","date: 2022-11-01<br />Wage: 3607156","date: 2022-12-01<br />Wage: 3627932","date: 2023-01-01<br />Wage: 3623061","date: 2023-02-01<br />Wage: 3292644"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(Red,Wage)","legendgroup":"(Red,Wage)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083],"y":[6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000],"text":["High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March","High wages <br />observed in <br />March"],"hovertext":["as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06","as.Date(\"2022-04-01\"): 2022-04-01<br />y: 6e+06"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],"y":[3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000],"text":["Wage","Wage","Wage","Wage","Wage","Wage","Wage","Wage","Wage","Wage","Wage","Wage"],"hovertext":["as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000","as.Date(\"2022-12-01\"): 2022-12-01<br />y: 3800000"],"textfont":{"size":9.4488188976378,"color":"rgba(255,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.2864259028643,"r":7.97011207970112,"b":57.1982804131844,"l":85.0145288501453},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022},"title":{"text":"Cumulative Income across Months","font":{"color":"rgba(0,0,0,1)","family":"","size":19.1282689912827},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[19035.15,19405.85],"tickmode":"array","ticktext":["Mar 2022","Apr 2022","May 2022","Jun 2022","Jul 2022","Aug 2022","Sep 2022","Oct 2022","Nov 2022","Dec 2022","Jan 2023","Feb 2023"],"tickvals":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],"categoryorder":"array","categoryarray":["Mar 2022","Apr 2022","May 2022","Jun 2022","Jul 2022","Aug 2022","Sep 2022","Oct 2022","Nov 2022","Dec 2022","Jan 2023","Feb 2023"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.98505603985056,"tickwidth":0.362277821804596,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":1.32835201328352,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"<b> Month <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-325000,6825000],"tickmode":"array","ticktext":["0","1,000,000","2,000,000","3,000,000","4,000,000","5,000,000","6,000,000"],"tickvals":[0,1000000,2000000,3000000,4000000,5000000,6000000],"categoryorder":"array","categoryarray":["0","1,000,000","2,000,000","3,000,000","4,000,000","5,000,000","6,000,000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.98505603985056,"tickwidth":0.362277821804596,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":1.32835201328352,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.362277821804596,"zeroline":false,"anchor":"x","title":{"text":"<b> Amount <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":2.06156048675734,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"548849877c0d":{"x":{},"y":{},"colour":{},"linetype":{},"type":"scatter"},"5488530e3168":{"x":{},"y":{},"label":{}},"5488cc243af":{"x":{},"y":{},"label":{}}},"cur_data":"548849877c0d","visdat":{"548849877c0d":["function (y) ","x"],"5488530e3168":["function (y) ","x"],"5488cc243af":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now lets examine the wages across the months closer using boxplots.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">March 22 to Feb 23</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">One way Anova plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Error plots</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The boxplot is able to show the distribution of wages of the residents across all the months. Wage is much higher in March and possible reasons could be due to Harvest / Bonus month. Are the medians of the month wage significantly different from one another? (See next tab)</p>
<div class="cell" data-fig.asp="0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df_wage_edu_month <span class="ot">&lt;-</span> finance1_wide_ptcp1 <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>df_wage_edu_month<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">month</span>(finance1_wide_ptcp1<span class="sc">$</span>date), </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mar 22"</span>, <span class="st">"Apr 22"</span>, <span class="st">"May 22"</span>, <span class="st">"Jun 22"</span>, <span class="st">"Jul 22"</span>, <span class="st">"Aug 22"</span>, <span class="st">"Sep 22"</span>, <span class="st">"Oct 22"</span>, <span class="st">"Nov 22"</span>, <span class="st">"Dec 22"</span>, <span class="st">"Jan 23"</span>, <span class="st">"Feb 23"</span>))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_wage_edu_month,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> Wage)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> educationLevel)) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Wage"</span>, <span class="at">fill =</span> <span class="st">"Education Level"</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"RdBu"</span>) <span class="sc">+</span> </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>,<span class="st">'cm'</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span> , <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The plot below shows us the pairs of months where wage are significantly different. See the next tab to see the error plots.</p>
<div class="cell" data-fig.asp="0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">data =</span> df_wage_edu_month, <span class="at">x =</span> month, <span class="at">y =</span> Wage,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Month"</span>, <span class="at">ylab =</span> <span class="st">"Wage"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"np"</span>, <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, <span class="at">pairwise.display =</span> <span class="st">"s"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort =</span> <span class="st">"descending"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort.fun =</span> median,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">mean.ci =</span> T, <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"Comparison of Median Wage across Months"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_y_continuous(limits = c(0, 300000)) +</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>As we are analyzing survey data, each of our sample mean could vary from the actual population mean. Thus we have to visualise the margin of error. The higher the CI, the higher the margin of error.</p>
<p>95% and 99% confidence intervals are constructed for the median wage for each month.</p>
<p>Note: A confidence level of 95% means the true result will be within the error bar range 95 times out of 100 sampling tries.</p>
<div class="cell" data-fig.asp="0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_wage_edu_month <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> Wage)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Using stat_pointinterval to plot the points and intervals</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.99</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">.point =</span> median,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">.interval =</span> qi,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">interval_color=</span><span class="fu">stat</span>(level)),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Defining the color of the intervals </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"darkblue"</span>),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">aesthetics =</span> <span class="st">"interval_color"</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Title, subtitle, and caption</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualising confidence intervals of median wage"</span>,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Median Point + Multiple-interval plot, 95% and 99%"</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Months"</span>, <span class="at">y =</span> <span class="st">"Wage"</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>, </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="next-plot-interactive-pending-coordinated-line-chart-of-expenditures-by-month" class="level3">
<h3 class="anchored" data-anchor-id="next-plot-interactive-pending-coordinated-line-chart-of-expenditures-by-month">Next Plot: Interactive (pending coordinated) Line chart of expenditures by month</h3>
<p>Design considerations:</p>
<p>Instead of combining Education, Recreation, Food and Shelter expense in one chart, I have plotted them on one chart each with different Y axis range. This will be enable us to visualise variability of amount across categories clearly.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> highlevel <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date,<span class="at">y =</span> Shelter)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> highlevel <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date,<span class="at">y =</span> Education)) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> highlevel <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date,<span class="at">y =</span> Food)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> highlevel <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date,<span class="at">y =</span> Recreation)) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_clean</span>()</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>(s <span class="sc">+</span>e) <span class="sc">/</span> (f<span class="sc">+</span>r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Work in progress.. tidy up axis ticks, titles title</li>
</ul>
<p>From all the plots above, March seems to be an exciting month where there is several anomalies observed. There are unusual spikes in wage, recreational and shelter spending.</p>
<p>Next, lets plot a coordinated dotplot to studying the distribution of expenses since we have the individual data of participant, which we can aggregated into annual expense. First prepare the annual dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>annual <span class="ot">&lt;-</span> finance1_wide_ptcp1 <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participantId, householdSize, haveKids, educationLevel, interestGroup, joviality) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Education =</span> <span class="fu">sum</span>(Education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Food =</span> <span class="fu">sum</span>(Food, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Recreation =</span> <span class="fu">sum</span>(Recreation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Shelter =</span> <span class="fu">sum</span>(Shelter, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Wage =</span> <span class="fu">sum</span>(Wage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">RentAdjustment =</span> <span class="fu">sum</span>(RentAdjustment, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the <strong><code>na.rm = TRUE</code></strong> argument is used in the <strong><code>sum</code></strong> function to handle missing values in the columns during aggregation.</p>
</div>
</div>
<p>DOTPLOT CODES</p>
<div class="cell">

</div>
<div class="cell">

</div>
</section>
<section id="interactive-heatmap-of-annual-recreation-spending-and-joviality-index" class="level3">
<h3 class="anchored" data-anchor-id="interactive-heatmap-of-annual-recreation-spending-and-joviality-index">3.1.3 Interactive Heatmap of annual recreation spending and joviality index</h3>
<p>SECTION WILL BE REMOVED</p>
<p>Next, prepare the data needed to generate a heatmap of annual recreational spendings by interest group and education level.</p>
<div class="cell">

</div>
<p>We are ready to plot the heatmap.</p>
<div class="cell">

</div>
<p>From the plot above, we are able to see the link between different education levels and their interests group. Hovering the mouse above the heatmaps will reveal the annual recreation spending and joviality index in the tooltip. The median joviality index is chosen because it is a point where the maximum distance between the smallest and highest spending or index is reduced. What inteeresting patterns can you see?</p>
<p>I can see that interest group J has higher recreation spending as compared to the rest and residents from the ‘low’ education level are contributing to it. From the joviality heatmap on the right, I also notice the same group of people are happiest of all. It makes me wonder what interest group it is in real life.</p>
<p>I will be performing CDA to compare the annual recreation spends in joviality index across education levels later.</p>
</section>
</section>
<section id="cda" class="level2">
<h2 class="anchored" data-anchor-id="cda">3.2 CDA</h2>
<section id="one-way-anova-plots-to-compare-wagerecreationjoviality-across-education-levels" class="level3">
<h3 class="anchored" data-anchor-id="one-way-anova-plots-to-compare-wagerecreationjoviality-across-education-levels">3.2.2 One-way Anova plots to compare Wage/Recreation/Joviality across Education levels</h3>
<section id="does-a-person-earn-more-if-heshe-is-more-highly-educated-in-the-city" class="level4">
<h4 class="anchored" data-anchor-id="does-a-person-earn-more-if-heshe-is-more-highly-educated-in-the-city">(1) Does a person earn more if he/she is more highly educated in the city?</h4>
<p>Since Wage does not follow normal distribution, I will choose a non parametric test to compare whether there is significant difference in the median of wage between education levels.</p>
<div class="cell" data-fig.asp="0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">data =</span> annual, <span class="at">x =</span> educationLevel, <span class="at">y =</span> Wage,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Education level"</span>, <span class="at">ylab =</span> <span class="st">"Annual Wage"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"np"</span>, <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, <span class="at">pairwise.display =</span> <span class="st">"s"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort =</span> <span class="st">"descending"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort.fun =</span> median,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">mean.ci =</span> T, <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"Comparison of Median Annual Wage across Education Levels"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">300000</span>)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>For 4 categories of education levels, we can have a total of 4C2 = k(k-1)/2 (=6) possible combinations of pairs.</p>
<p>From the results, all six pairwise comparison p-values are less than 0.05 and thus we can reject the null hypothesis and conclude that the median wages across all different educational levels are all different from one another.</p>
</section>
<section id="visualising-the-uncertainty-of-point-estimates" class="level4">
<h4 class="anchored" data-anchor-id="visualising-the-uncertainty-of-point-estimates">(1.1) Visualising the uncertainty of point estimates</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>annual <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> educationLevel, <span class="at">y =</span> Wage)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Using stat_pointinterval to plot the points and intervals</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pointinterval</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.99</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">.point =</span> median,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">.interval =</span> qi,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">interval_color=</span><span class="fu">stat</span>(level)),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Defining the color of the intervals </span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"darkblue"</span>),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">aesthetics =</span> <span class="st">"interval_color"</span>) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Title, subtitle, and caption</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualising confidence intervals of median math score"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Median Point + Multiple-interval plot, 95% and 99%"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Education  level"</span>, <span class="at">y =</span> <span class="st">"Wage"</span>) <span class="sc">+</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>, </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face=</span><span class="st">'bold'</span>),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The error bar for mean Median Wage is the longest for Graduate education level and this could be due to outliers in this category.</p>
</section>
<section id="is-there-a-significant-difference-in-the-median-of-recreational-spending-across-education-levels" class="level4">
<h4 class="anchored" data-anchor-id="is-there-a-significant-difference-in-the-median-of-recreational-spending-across-education-levels">(2) Is there a significant difference in the median of recreational spending across education levels?</h4>
<p>Perform a test to confirm whether recreational spending follows the normal distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(annual,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample=</span>Recreation)) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"QQ plot with Shapiro-Wilk test results"</span>)  </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>sw_t <span class="ot">&lt;-</span> <span class="fu">shapiro_test</span>(annual<span class="sc">$</span>Recreation) <span class="sc">%&gt;%</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Recreation Spending"</span>)<span class="sc">%&gt;%</span> <span class="fu">gt</span>()  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">'.png'</span>) <span class="co"># create  temp table</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gtsave</span>(sw_t, tmp)  <span class="co"># use gtsave() to save sw_t into tmp folder</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>table_png <span class="ot">&lt;-</span> png<span class="sc">::</span><span class="fu">readPNG</span>(tmp, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>qq<span class="sc">+</span>table_png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have enough statistical evidence to reject the null hypothesis that recreational spending follows normal distribution. Use a non parametric test below to test for difference in median of recreation spending across education levels.</p>
<div class="cell" data-fig.asp="0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">data =</span> annual, <span class="at">x =</span> educationLevel, <span class="at">y =</span> Recreation,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Education level"</span>, <span class="at">ylab =</span> <span class="st">"Annual Recreation"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"np"</span>, <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, <span class="at">pairwise.display =</span> <span class="st">"ns"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort =</span> <span class="st">"descending"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort.fun =</span> median,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">mean.ci =</span> T, <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"Comparison of Median Annual Recreation spending across Education Levels"</span>) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>From the results, all six pairwise comparison p-values are greater 0.05 and thus we do not have enough statistical evidence to reject the null hypothesis that the median recreation spending across all different educational levels are all different.</p>
</section>
<section id="is-there-a-significant-difference-in-median-of-the-joviality-index-across-education-levels" class="level4">
<h4 class="anchored" data-anchor-id="is-there-a-significant-difference-in-median-of-the-joviality-index-across-education-levels">(3) Is there a significant difference in median of the joviality index across education levels?</h4>
<p>Perform a test to confirm whether joviality index follows the normal distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(annual,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample=</span>joviality)) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"QQ plot with Shapiro-Wilk test results"</span>)  </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>sw_t <span class="ot">&lt;-</span> <span class="fu">shapiro_test</span>(annual<span class="sc">$</span>joviality) <span class="sc">%&gt;%</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">"Joviality Index"</span>)<span class="sc">%&gt;%</span> <span class="fu">gt</span>()  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">'.png'</span>) <span class="co"># create  temp table</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gtsave</span>(sw_t, tmp)  <span class="co"># use gtsave() to save sw_t into tmp folder</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>table_png <span class="ot">&lt;-</span> png<span class="sc">::</span><span class="fu">readPNG</span>(tmp, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>qq<span class="sc">+</span>table_png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have enough statistical evidence to reject the null hypothesis that joviality index follows normal distribution. Use a non parametric test below to test for difference in median of joviality index across education levels.</p>
<div class="cell" data-fig.aspect="fig-width*0.618">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">data =</span> annual, <span class="at">x =</span> educationLevel, <span class="at">y =</span> joviality,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Education level"</span>, <span class="at">ylab =</span> <span class="st">"Joviality Index"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"np"</span>, <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, <span class="at">pairwise.display =</span> <span class="st">"ns"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort =</span> <span class="st">"descending"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">sort.fun =</span> median,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">mean.ci =</span> T, <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"Comparison of Median Joviality index across Education Levels"</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust=</span><span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>From the results, only 2 pairwise comparison p-values &lt;0.05 and thus we can reject the null hypothesis for (High School &amp; Graduate) and (High School &amp; Bachelors) and conclude that the median Joviality index for these two pairs of education levels are different.</p>
</section>
</section>
<section id="correlation-between-annual-shelter-cost-and-annual-wage" class="level3">
<h3 class="anchored" data-anchor-id="correlation-between-annual-shelter-cost-and-annual-wage">3.2.3 Correlation between Annual Shelter cost and Annual Wage</h3>
<p>In this section, we will investigate if people who earn more will also spend more on shelter. We will also subset the data across education levels.</p>
<p>We will use the non-parametric Spearman correlation analysis instead of Pearson correlation since the wage data is not normally distributed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>low_correl <span class="ot">&lt;-</span> <span class="fu">ggscatterstats</span>(<span class="at">data =</span> annual <span class="sc">|&gt;</span> <span class="fu">filter</span>(educationLevel <span class="sc">==</span> <span class="st">"Low"</span>), </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> Wage, <span class="at">y =</span> Shelter,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70000</span>), </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70000</span>, <span class="dv">10000</span>), </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>), </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">5000</span>), </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Low Education Status"</span>, </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Annual Wage"</span>, <span class="at">y =</span> <span class="st">"Annual Shelter fee"</span>) </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>high_correl <span class="ot">&lt;-</span> <span class="fu">ggscatterstats</span>(<span class="at">data =</span> annual <span class="sc">|&gt;</span> <span class="fu">filter</span>(educationLevel <span class="sc">==</span> <span class="st">"HighSchoolOrCollege"</span>), </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> Wage, <span class="at">y =</span> Shelter,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="sc">+</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70000</span>), </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70000</span>, <span class="dv">10000</span>), </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span> </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>), </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">5000</span>), </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"High Sch Education Status"</span>, </span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Annual Wage"</span>, <span class="at">y =</span> <span class="st">"Annual Shelter fee"</span>) </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>bac_correl <span class="ot">&lt;-</span> <span class="fu">ggscatterstats</span>(<span class="at">data =</span> annual <span class="sc">|&gt;</span> <span class="fu">filter</span>(educationLevel <span class="sc">==</span> <span class="st">"Bachelors"</span>), </span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> Wage, <span class="at">y =</span> Shelter,</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="sc">+</span> </span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70000</span>), </span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70000</span>, <span class="dv">10000</span>), </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span> </span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>), </span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">5000</span>), </span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Degree Education Status"</span>, </span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Annual Wage"</span>, <span class="at">y =</span> <span class="st">"Annual Shelter fee"</span>) </span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>grad_correl <span class="ot">&lt;-</span> <span class="fu">ggscatterstats</span>(<span class="at">data =</span> annual <span class="sc">|&gt;</span> <span class="fu">filter</span>(educationLevel <span class="sc">==</span> <span class="st">"Graduate"</span>), </span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> Wage, <span class="at">y =</span> Shelter,</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="sc">+</span> </span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70000</span>),</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70000</span>, <span class="dv">10000</span>), </span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span> </span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>),</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">5000</span>), </span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span> comma) <span class="sc">+</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Graduate Education Status"</span>, </span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Annual Wage"</span>, <span class="at">y =</span> <span class="st">"Annual Shelter fee"</span>) </span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="co"># combining plots using patchwork</span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>p_correl <span class="ot">&lt;-</span> (low_correl <span class="sc">+</span> high_correl) <span class="sc">/</span> (bac_correl <span class="sc">+</span> grad_correl) <span class="sc">+</span> <span class="fu">plot_spacer</span>()</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>p_correl <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Correlation between Shelter spending and Annual Wage"</span>, </span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>                           <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>H0: There is no [monotonic] association between the annual shelter fees and wage.</p>
<p>H1: There is association between the annual shelter fees and wage.</p>
<p>From the plots above, there are no strong correlation values above 0.7. only the ‘low’ and ‘degree’ education group showed p-values less than 0.05 which shows that there is a significant association between shelter fee and wage. However, the correlation is weak between shelter spending and wage.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Spearman correlation</p>
<p>The Spearman correlation is not a linear correlation of the data, but a linear correlation of a transformed version of the data -- specifically, the correlation of the rank-transformed data. Do not be mislead by the slope direction.</p>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1"></h3>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>4 References</h1>
<p>Heat Map with ggplot2. (2023). Retrieved May 9, 2023, from <a href="https://r-charts.com/correlation/heat-map-ggplot2/#:~:text=Heat%20map%20with%20geom_tile,-A%20heap%20map&amp;text=You%20can%20customize%20the%20border,%2C%20lwd%20and%20linetype%20%2C%20respectively.&amp;text=In%20addition%2C%20you%20can%20add,argument%20of%20the%20aes%20function" class="uri">https://r-charts.com/correlation/heat-map-ggplot2/#:~:text=Heat%20map%20with%20geom_tile,-A%20heap%20map&amp;text=You%20can%20customize%20the%20border,%2C%20lwd%20and%20linetype%20%2C%20respectively.&amp;text=In%20addition%2C%20you%20can%20add,argument%20of%20the%20aes%20function</a>.</p>
<p>Downward slope but Spearman correlation coefficient is positive (and vice versa). (2022, April 5). In Stack Exchange. Retrieved May 9, 2023, from <a href="https://stats.stackexchange.com/questions/545516/downward-slope-but-spearman-correlation-coefficient-is-positive-and-vice-versa" class="uri">https://stats.stackexchange.com/questions/545516/downward-slope-but-spearman-correlation-coefficient-is-positive-and-vice-versa</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>