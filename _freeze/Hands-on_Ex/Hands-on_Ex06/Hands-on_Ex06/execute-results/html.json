{
  "hash": "3a1b79726d2b1d1927987314f3efe8b8",
  "result": {
    "markdown": "---\ntitle: \"Hands-on_Ex06\"\nauthor: \"NeoYX\"\ndate: '5 May 2023'\ndate-modified: \"2023-05-06\"\neditor: visual\nexecute: \n  freeze: auto\n  warning: false\n  #echo: false\n  #message: false\n  html:\n    code-fold: True\n    code-overflow: scroll\n    code-summary: \"Show the code\"\n    code-line-numbers: true\n---\n\n\n# 10Â  Visualising Uncertainty\n\n## 10.1 Learning Outcome\n\n## 10.2 Visualizing the uncertainty of point estimates\n\n-   A point estimate is a single number, such as a mean.\n\nUncertainty is expressed as standard error, confidence interval, or credible interval\n\n::: callout-important\nDon't confuse the uncertainty of a point estimate (mean, median..) with the variation in the sample (standard deviation sigma, and variation sigma square etc).\n\nThe standard deviation measures the variation of the values from the mean of ONE sample.\n\nThe standard error is the standard deviation of both sides of the 'mother of all means' of all the sample means. \\<- refer lecture 4 slide 23\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, plotly, crosstalk, DT, ggdist, gganimate, ggiraph)\n```\n:::\n\n\n-   [**DT**](https://rstudio.github.io/DT/) provides an R interface to the JavaScript library [DataTables](https://datatables.net/) that create interactive table on html page.\n\n-   [Crosstalk](https://rstudio.github.io/crosstalk/) is an add-on to the htmlwidgets package. It extends htmlwidgets with a set of classes, functions, and conventions for implementing cross-widget interactions (currently, linked brushing and filtering).\n\n-   [ggdist](https://mjskay.github.io/ggdist/) is an R package that provides a flexible set of `ggplot2` geoms and stats designed especially for **visualizing** distributions and uncertainty.\n\n    Lets load the student exam data.csv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam <- read_csv('C:/yixin-neo/ISSS608-VAA/Hands-on_Ex/Hands-on_Ex05/data/Exam_data.csv')\n```\n:::\n\n\n### 10.2.1 Visualizing the uncertainty of point estimates: Manual calculation and creating of my_sum table\n\nThe code chunk below performs the followings:\n\n-   group the observation by RACE,\n\n-   computes the count of observations, mean, standard deviation and standard error of Maths by RACE, and\n\n-   save the output as a tibble data table called `my_sum`.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    my_sum <- exam %>% \n      group_by(RACE) %>% \n      summarise(n=n(),\n                mean=mean(MATHS),\n                sd = sd(MATHS)) %>% \n      mutate(se=sd/sqrt(n-1))   #<<< standard error formula\n    ```\n    :::\n\n\nRefer to lecture 4 slide 20 for mathematical formula explanation.\n\nmy_sum is specially created for visualisation later using ggplot2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(head(my_sum), format = 'html')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> RACE </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> se </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Chinese </td>\n   <td style=\"text-align:right;\"> 193 </td>\n   <td style=\"text-align:right;\"> 76.50777 </td>\n   <td style=\"text-align:right;\"> 15.69040 </td>\n   <td style=\"text-align:right;\"> 1.132357 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Indian </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 60.66667 </td>\n   <td style=\"text-align:right;\"> 23.35237 </td>\n   <td style=\"text-align:right;\"> 7.041005 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Malay </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 57.44444 </td>\n   <td style=\"text-align:right;\"> 21.13478 </td>\n   <td style=\"text-align:right;\"> 2.043177 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Others </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 69.66667 </td>\n   <td style=\"text-align:right;\"> 10.72381 </td>\n   <td style=\"text-align:right;\"> 3.791438 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### 10.2.2 Visualizing the uncertainty of point estimates: Use my_sum table and ggplot2 methods to plot uncertainty\n\nThe code chunk below is used to reveal the **standard error** of **mean** maths score by race. It shows **one** standard deviation away from the 'mother of all means' for all the means from all the samples.\n\n::: callout-note\nStandard error is a measure of the variation of the mean of all the means from all samples of an underlying distribution.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my_sum) +\n  geom_errorbar(aes(x=RACE,\n                    ymin=mean-se,\n                    ymax=mean+se),\n                width = 0.2,\n                colour = 'black',\n                alpha = 0.9,\n                size=0.5) +\n    geom_point(aes(x=RACE,\n                 y=mean),\n             stat = 'identity', #<<< actual points refer to mean \n             color='red', \n             size = 1.5,\n             alpha = 1) + \n  ggtitle('Standard error of mean maths score by race')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\nIn the code above, **`stat = 'identity'`** means that the **`y`** values in the **`geom_point`** layer correspond to the **actual values** in the data frame, rather than a summary statistic like mean or median.\n:::\n\n### 10.2.3 Visualizing the uncertainty of point estimates: **ggplot2** methods\n\nLets plot a 95% confidence interval of mean maths score by race. The error bars should be sorted by the average maths scores. (Refer to take-home ex 1 on sorting by mean)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my_sum) +\n  geom_errorbar(aes(x=reorder(RACE,-mean),  # reorder(x,y) means to reorder x based on increasing or decreasing values of y. To sort by descending values of Y, use -Y.\n                    ymin=mean-1.96*se,    #<<<< formula to calc 95% CI\n                    ymax=mean+ 1.96*se),  #<<<<\n                width = 0.2,\n                colour = 'black',\n                alpha = 0.9,\n                size=0.5) +\n    geom_point(aes(x=RACE,\n                 y=mean),\n             stat = 'identity', #<<< actual points refer to mean \n             color='red', \n             size = 1.5,\n             alpha = 1) + \n  ggtitle('95% confidence interval of maths score by race')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex06_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## What is the difference between standard error plot above and this 95% confidence interval plot?\n\nEarlier , we plot error bars of 1 standard deviation away from the mother of all means.\n\nHere, we are plotting 1.96 \\* standard deviation away from the mother of all means. The higher the % CI, the greater the margin or error.\n:::\n\n### 10.2.4 Visualizing the uncertainty of point estimates with interactive error bars\n\n**Task: Plot an interactive error bars for the 99% confidence interval of mean maths score by race.**\n\nRecall in hands-on 3 that we create can create interactive plots using [ggiraph](https://davidgohel.github.io/ggiraph/) and [ggplot geometries](https://davidgohel.github.io/ggiraph/reference/#section-interactive-geometries) that can understand 3 arguments; namely **tooltip**, **data_id** and **onclick**.\nI will use one of them methods (geom_errorbar_interactive with girafe) to construct here. The other method is to use plotly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a new column tooltip to contain the tooltip text.\nmy_sum$tooltip <- c(paste0(\"RACE: \",\n                           my_sum$RACE,\n                           \"\\n N= \",\n                            my_sum$n,\n                           \"\\n Ave Score: \",\n                           round(my_sum$mean, digits=2)\n                           ))\n\np <- ggplot(my_sum) +\n  geom_errorbar_interactive(aes(x=reorder(RACE,-mean),\n                    ymin=mean-2.58*se,    #<<<< formula to calc 95% CI\n                    ymax=mean+ 2.58*se,\n                    tooltip=tooltip),  \n                width = 0.2,\n                colour = 'black',\n                alpha = 0.9,\n                size=0.5) +\n    geom_point(aes(x=RACE,\n                 y=mean),\n             stat = 'identity', #<<< actual points refer to mean \n             color='red', \n             size = 1.5,\n             alpha = 1) + \n  labs(title='99% confidence interval of maths score by race',\n       x = 'Race') +\n  theme(axis.title.y=element_text(angle = 0,\n                                  vjust=0.9),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        axis.title = element_text(face = \"bold\"),\n        axis.line = element_line(size = 0.2))\n\ngirafe(ggobj = p,\n       width_svg = 8,\n       height_svg = 8*0.618)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"girafe html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-a115aab114ebf6ea97ed\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a115aab114ebf6ea97ed\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='img' id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519' viewBox='0 0 576 355.97'>\\n <defs id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_defs'>\\n  <clipPath id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_c1'>\\n   <rect x='0' y='0' width='576' height='355.97'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_c2'>\\n   <rect x='51.69' y='23.18' width='518.84' height='280.85'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_c1)'>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_c2)'>\\n   <rect x='51.69' y='23.18' width='518.84' height='280.85' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\\n   <polyline points='51.69,273.99 570.52,273.99' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,204.89 570.52,204.89' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,135.79 570.52,135.79' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,66.68 570.52,66.68' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,239.44 570.52,239.44' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,170.34 570.52,170.34' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,101.24 570.52,101.24' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,32.13 570.52,32.13' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='125.80,304.03 125.80,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='249.34,304.03 249.34,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.87,304.03 372.87,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='496.40,304.03 496.40,23.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e1' points='113.45,36.08 138.16,36.08' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Chinese&amp;lt;br/&amp;gt; N= 193&amp;lt;br/&amp;gt; Ave Score: 76.51'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e2' points='125.80,36.08 125.80,76.45' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Chinese&amp;lt;br/&amp;gt; N= 193&amp;lt;br/&amp;gt; Ave Score: 76.51'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e3' points='113.45,76.45 138.16,76.45' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Chinese&amp;lt;br/&amp;gt; N= 193&amp;lt;br/&amp;gt; Ave Score: 76.51'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e4' points='360.52,40.20 385.22,40.20' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Indian&amp;lt;br/&amp;gt; N= 12&amp;lt;br/&amp;gt; Ave Score: 60.67'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e5' points='372.87,40.20 372.87,291.26' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Indian&amp;lt;br/&amp;gt; N= 12&amp;lt;br/&amp;gt; Ave Score: 60.67'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e6' points='360.52,291.26 385.22,291.26' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Indian&amp;lt;br/&amp;gt; N= 12&amp;lt;br/&amp;gt; Ave Score: 60.67'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e7' points='484.05,151.57 508.75,151.57' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Malay&amp;lt;br/&amp;gt; N= 108&amp;lt;br/&amp;gt; Ave Score: 57.44'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e8' points='496.40,151.57 496.40,224.43' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Malay&amp;lt;br/&amp;gt; N= 108&amp;lt;br/&amp;gt; Ave Score: 57.44'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e9' points='484.05,224.43 508.75,224.43' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Malay&amp;lt;br/&amp;gt; N= 108&amp;lt;br/&amp;gt; Ave Score: 57.44'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e10' points='236.98,35.94 261.69,35.94' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Others&amp;lt;br/&amp;gt; N= 9&amp;lt;br/&amp;gt; Ave Score: 69.67'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e11' points='249.34,35.94 249.34,171.14' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Others&amp;lt;br/&amp;gt; N= 9&amp;lt;br/&amp;gt; Ave Score: 69.67'/>\\n   <polyline id='svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_e12' points='236.98,171.14 261.69,171.14' fill='none' stroke='#000000' stroke-opacity='0.9' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='RACE: Others&amp;lt;br/&amp;gt; N= 9&amp;lt;br/&amp;gt; Ave Score: 69.67'/>\\n   <circle cx='125.8' cy='56.27' r='1.47pt' fill='#FF0000' fill-opacity='1' stroke='#FF0000' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\\n   <circle cx='372.87' cy='165.73' r='1.47pt' fill='#FF0000' fill-opacity='1' stroke='#FF0000' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\\n   <circle cx='496.4' cy='188' r='1.47pt' fill='#FF0000' fill-opacity='1' stroke='#FF0000' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\\n   <circle cx='249.34' cy='103.54' r='1.47pt' fill='#FF0000' fill-opacity='1' stroke='#FF0000' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_91d7a9ae_2468_4a90_b0b4_05db733ef519_c1)'>\\n   <polyline points='51.69,304.03 51.69,23.18' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='36.96' y='242.59' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>50<\\/text>\\n   <text x='36.96' y='173.49' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>60<\\/text>\\n   <text x='36.96' y='104.39' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>70<\\/text>\\n   <text x='36.96' y='35.28' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>80<\\/text>\\n   <polyline points='48.95,239.44 51.69,239.44' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='48.95,170.34 51.69,170.34' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='48.95,101.24 51.69,101.24' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='48.95,32.13 51.69,32.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='51.69,304.03 570.52,304.03' fill='none' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='125.80,306.77 125.80,304.03' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='249.34,306.77 249.34,304.03' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.87,306.77 372.87,304.03' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='496.40,306.77 496.40,304.03' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text transform='translate(107.43,336.25) rotate(-45.00)' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Chinese<\\/text>\\n   <text transform='translate(235.11,332.10) rotate(-45.00)' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Others<\\/text>\\n   <text transform='translate(360.37,330.38) rotate(-45.00)' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Indian<\\/text>\\n   <text transform='translate(484.26,330.01) rotate(-45.00)' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Malay<\\/text>\\n   <text x='297.95' y='348.17' font-size='8.25pt' font-weight='bold' font-family='Arial'>Race<\\/text>\\n   <text x='5.48' y='58.35' font-size='8.25pt' font-weight='bold' font-family='Arial'>mean<\\/text>\\n   <text x='51.69' y='14.93' font-size='9.9pt' font-family='Arial'>99% confidence interval of maths score by race<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_91d7a9ae_2468_4a90_b0b4_05db733ef519\",\"ratio\":1.61812297734628,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n**Next task: Create an interactive Data Table beside the interactive error bars (also with coordinated views)**\n\nFirst, we create an interactive Data Table using DT().\n - We use the **`%>%`** operator to pipe the data frame into the **`mutate_if()`** function, where we specify the condition **`is.numeric`** to select only the numeric columns. We use the tilde **`~`** symbol to specify the rounding function, and pass the **`digits`** argument to round to two decimal places. The resulting data frame **`df`** will have all numerical columns rounded to two decimal places.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Round all numerical columns to two decimal places\nmy_sum <- my_sum %>% \n  mutate_if(is.numeric, ~ round(., digits = 2))\n\nDT::datatable(my_sum, class='compact')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-ec77392e951e6984e38e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ec77392e951e6984e38e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"Chinese\",\"Indian\",\"Malay\",\"Others\"],[193,12,108,9],[76.51,60.67,57.44,69.67],[15.69,23.35,21.13,10.72],[1.13,7.04,2.04,3.79],[\"RACE: Chinese\\n N= 193\\n Ave Score: 76.51\",\"RACE: Indian\\n N= 12\\n Ave Score: 60.67\",\"RACE: Malay\\n N= 108\\n Ave Score: 57.44\",\"RACE: Others\\n N= 9\\n Ave Score: 69.67\"]],\"container\":\"<table class=\\\"compact\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>RACE<\\/th>\\n      <th>n<\\/th>\\n      <th>mean<\\/th>\\n      <th>sd<\\/th>\\n      <th>se<\\/th>\\n      <th>tooltip<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nNext, combine uncertainty graph and **plotly** interactive table using [Crosstalk](https://rstudio.github.io/crosstalk/), which is an add-on to the htmlwidgets package. It extends htmlwidgets with a set of classes, functions, and conventions for implementing cross-widget interactions (currently, linked brushing and filtering).\n\n(refer to hands-on 3)\n\nThe datatable is linked to the visualisation on the left. Click on multiple rows to filter according.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Use highlight_key() to add a unique key to the data frame my_sum3 so that it can be linked to interactive plots later\nd <- highlight_key(my_sum) \n\n\np <- ggplot(d) +\n  geom_errorbar(aes(x=reorder(RACE,-mean),\n                    ymin=mean-2.58*se,    #<<<< formula to calc 95% CI\n                    ymax=mean+ 2.58*se),  \n                width = 0.2,\n                colour = 'black',\n                alpha = 0.9,\n                size=0.5) +\n    geom_point(aes(x=RACE,\n                 y=mean),\n             stat = 'identity', #<<< actual points refer to mean \n             color='red', \n             size = 1.5,\n             alpha = 1) + \n  labs(title='99% confidence interval of maths score by race',\n       x = 'Race') +\n  theme(axis.title.y=element_text(angle = 0,\n                                  vjust=0.9),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        axis.title = element_text(face = \"bold\"),\n        axis.line = element_line(size = 0.2))\n\n# Convert ggplot to an interactive plotly plot using the ggplotly(), \"plotly click\" specifies that highlight should be based on click\ngg <- highlight(ggplotly(p),        \n                \"plotly_selected\")  \n\ncrosstalk::bscols(list(width = 7,gg),\n                  list(width=5,DT::datatable(d)),\n                  widths=5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"container-fluid crosstalk-bscols\">\n<div class=\"row\">\n<div class=\"col-xs-5\">\n7\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-12a09a872dbbe7379bd5\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-12a09a872dbbe7379bd5\">{\"x\":{\"data\":[{\"x\":[1,3,4,2],\"y\":[76.51,60.67,57.44,69.67],\"text\":[\"reorder(RACE, -mean): Chinese<br />mean - 2.58 * se: 73.5946<br />mean + 2.58 * se: 79.4254\",\"reorder(RACE, -mean): Indian<br />mean - 2.58 * se: 42.5068<br />mean + 2.58 * se: 78.8332\",\"reorder(RACE, -mean): Malay<br />mean - 2.58 * se: 52.1768<br />mean + 2.58 * se: 62.7032\",\"reorder(RACE, -mean): Others<br />mean - 2.58 * se: 59.8918<br />mean + 2.58 * se: 79.4482\"],\"key\":[\"1\",\"2\",\"3\",\"4\"],\"type\":\"scatter\",\"mode\":\"lines\",\"opacity\":0.9,\"line\":{\"color\":\"transparent\"},\"error_y\":{\"array\":[2.91540000000001,18.1632,5.2632,9.7782],\"arrayminus\":[2.91540000000001,18.1632,5.2632,9.7782],\"type\":\"data\",\"width\":24.3809523809524,\"symmetric\":false,\"color\":\"rgba(0,0,0,1)\"},\"set\":\"SharedDataa115aab1\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[1,3,4,2],\"y\":[76.51,60.67,57.44,69.67],\"text\":[\"RACE: Chinese<br />mean: 76.51\",\"RACE: Indian<br />mean: 60.67\",\"RACE: Malay<br />mean: 57.44\",\"RACE: Others<br />mean: 69.67\"],\"key\":[\"1\",\"2\",\"3\",\"4\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,0,0,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(255,0,0,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedDataa115aab1\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.2754946727549,\"r\":7.30593607305936,\"b\":50.3587563690382,\"l\":51.8721461187215},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"title\":{\"text\":\"99% confidence interval of maths score by race\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.5342465753425},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,4.6],\"tickmode\":\"array\",\"ticktext\":[\"Chinese\",\"Others\",\"Indian\",\"Malay\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Chinese\",\"Others\",\"Indian\",\"Malay\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.265670402656704,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"<b> Race <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[40.65973,81.29527],\"tickmode\":\"array\",\"ticktext\":[\"50\",\"60\",\"70\",\"80\"],\"tickvals\":[50,60,70,80],\"categoryorder\":\"array\",\"categoryarray\":[\"50\",\"60\",\"70\",\"80\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.265670402656704,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"<b> mean <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"dragmode\":\"select\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"5524665b2d5b\":{\"x\":{},\"ymin\":{},\"ymax\":{},\"type\":\"scatter\"},\"552448c92bb5\":{\"x\":{},\"y\":{}}},\"cur_data\":\"5524665b2d5b\",\"visdat\":{\"5524665b2d5b\":[\"function (y) \",\"x\"],\"552448c92bb5\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_selected\",\"off\":\"plotly_deselect\",\"persistent\":false,\"dynamic\":false,\"color\":null,\"selectize\":false,\"defaultValues\":null,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0,\"ctGroups\":[\"SharedDataa115aab1\"]},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n<div class=\"col-xs-5\">\n5\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4ce60abd742b7451c220\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ce60abd742b7451c220\">{\"x\":{\"crosstalkOptions\":{\"key\":[\"1\",\"2\",\"3\",\"4\"],\"group\":\"SharedDataa115aab1\"},\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"Chinese\",\"Indian\",\"Malay\",\"Others\"],[193,12,108,9],[76.51,60.67,57.44,69.67],[15.69,23.35,21.13,10.72],[1.13,7.04,2.04,3.79],[\"RACE: Chinese\\n N= 193\\n Ave Score: 76.51\",\"RACE: Indian\\n N= 12\\n Ave Score: 60.67\",\"RACE: Malay\\n N= 108\\n Ave Score: 57.44\",\"RACE: Others\\n N= 9\\n Ave Score: 69.67\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>RACE<\\/th>\\n      <th>n<\\/th>\\n      <th>mean<\\/th>\\n      <th>sd<\\/th>\\n      <th>se<\\/th>\\n      <th>tooltip<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n</div>\n</div>\n```\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/d3-bundle-5.16.0/d3-bundle.min.js\"></script>\r\n<script src=\"../../site_libs/d3-lasso-0.0.5/d3-lasso.min.js\"></script>\r\n<script src=\"../../site_libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js\"></script>\r\n<script src=\"../../site_libs/flatbush-4.0.0/flatbush.min.js\"></script>\r\n<link href=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.js\"></script>\r\n<script src=\"../../site_libs/girafe-binding-0.8.7/girafe.js\"></script>\r\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/datatables-binding-0.27/datatables.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<script src=\"../../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n<link href=\"../../site_libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}