{
  "hash": "29f185571dece8a15ad7efeb16e8493b",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex01\"\nauthor: \"NeoYX\"\ndate: '7 May 2023'\n#date-modified: \"2023-05-09\"\neditor: visual\nexecute: \n  freeze: auto\n  warning: false\n  #echo: false\n  #message: false\n  html:\n    code-fold: True\n    code-overflow: scroll\n    code-summary: \"Show the code\"\n    code-line-numbers: true\n---\n\n\n# 1. Task and Dataset\n\nThis exerise aims to reveal the demographic and financial characteristics of the city of Engagement, using appropriate **static and interactive statistical graphics** methods. It also requires a user-friendly and interactive solution that helps city managers and planners to explore the complex data in an engaging way and reveal hidden patterns.\n\nThe dataset consists of a sample survey of 1000 representative residents that collects data related to their household demographic and spending patterns, among other things. There are primarily two datasets used in this exercise\n\n-   'FinancialJournal.csv\": Contains 1513635 number of daily transaction records (different categories of income and expenses) over a period of twelve months from March 2022 to February 2023.\n\n-   'Particpants.csv\" : Contains demographics information like household size, age, education level, interest groups, joviality index and whether each household has kids.\n\nIn this exercise, each dataset will be cleansed separately and then joined by 'participantID' as primary key to form the final dataset used for further analysis.\n\n# \n\n# 2. Data Preparation\n\n## 2.1 Install and load the required libraries\n\nThe code chunk below uses `pacman::p_load()` to check if packages are installed. If they are, they will be launched into R. The packages installed are\n\n-   `plotly`: Used for creating interactive web-based graphs.\n\n-   `knitr`: Used for dynamic report generation\n\n-   `patchwork`: Used to combine plots\n\n-   `tidyverse`: A collection of core packages designed for data science, used extensively for data preparation and wrangling.\n\n-   `ggthemes`: Provide additional themes for `ggplot2`\n\n-   `ggstatsplot`: Used for creating graphics with details from statistical tests.\n\n-   `ggdist`: Used for visualising distribution and uncertainty\n\n-   `rstatix`: Allows us to perform basic statistical tests, including t-test, Wilcoxon test, ANOVA, Kruskal-Wallis and correlation analyses.\n\n-   `gt` : starting from a tibble table, customise a table and export in various formats. Most importantly, it works with patch. We will save the tabular results from shapiro test as gt object and export using gtsave() into .png file later.\n\n-   \n\n-   \n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(plotly, knitr, patchwork, tidyverse, ggthemes,hrbrthemes, ggiraph, ggstatsplot, ggdist, png, gifski, rstatix, gt, nortest)\n```\n:::\n\n\n## 2.2 Import the dataset\n\nThe datasets are imported using `tidyverse`'s `readr::read_csv()` function.\n\n'FinancialJournal.csv\" is stored as `finance` variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance <- read_csv('data/FinancialJournal.csv')\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  participantId timestamp           category  amount\n          <dbl> <dttm>              <chr>      <dbl>\n1             0 2022-03-01 00:00:00 Wage      2473. \n2             0 2022-03-01 00:00:00 Shelter   -555. \n3             0 2022-03-01 00:00:00 Education  -38.0\n4             1 2022-03-01 00:00:00 Wage      2047. \n5             1 2022-03-01 00:00:00 Shelter   -555. \n6             1 2022-03-01 00:00:00 Education  -38.0\n```\n:::\n:::\n\n\nCheck for empty values in the `finance` table using the `is.na()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(finance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n'Particpants.csv\" is stored as `ptcp` variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp <- read_csv('data/Participants.csv')\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  participantId householdSize haveKids   age educationLevel      interestGroup\n          <dbl>         <dbl> <lgl>    <dbl> <chr>               <chr>        \n1             0             3 TRUE        36 HighSchoolOrCollege H            \n2             1             3 TRUE        25 HighSchoolOrCollege B            \n3             2             3 TRUE        35 HighSchoolOrCollege A            \n4             3             3 TRUE        21 HighSchoolOrCollege I            \n5             4             3 TRUE        43 Bachelors           H            \n6             5             3 TRUE        32 HighSchoolOrCollege D            \n# ℹ 1 more variable: joviality <dbl>\n```\n:::\n:::\n\n\nChecking for empty values in `ptcp` table using the `is.na()`\\` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(ptcp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n## 2.3 Data Issues and wrangling\n\nI will discuss the issues in the datasets and proposed cleaning methods.\n\n### 2.3.1 **finance** dataset issues:\n\n-   **participantId** should be converted from `<dbl>` format to `<chr>` format. It should be a categorical and not numerical data type.\n\n-   **timestamp** should be converted from `<dttm>` format to `<date>` format as I will not be analysing time in this exercise.\n\n-   Negative values of **amount** that belong to the expenses categories should be converted to positive values. The amount will also be rounded to two decimal places.\n\nThe code chunk below does the following:\n\n-   use the **`as.character()`** function to convert **participantId** to `<chr>` format\n\n-   create a new column **month_year** by extracting the year and month from the **timestamp** column using the **`format()`** function with the **`%Y-%m`** format specifier.\n\n-   use the **`abs()`** function to convert negative values **amount** to positive and round the values to 2 decimal places using the **`round()`** function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert participantId to character\nfinance <- finance %>% mutate(participantId = as.character(participantId))\n\n# Extract month and year from timestamp\nfinance <- finance %>% \n  mutate(month_year = format(timestamp, \"%m-%Y\"))\n\n# Transform negative amounts to positive and round to 2 decimal places\nfinance <- finance %>% \n  mutate(amount = abs(amount),\n         amount = round(amount, 2))\n```\n:::\n\n\nA check for duplicates using the `duplicated()` function reveals that there are 1,113 records of duplicates.\n\n-   The **`duplicated()`** function to identify the duplicate rows. It returns a logical vector indicating whether each row is a duplicate of a previous row in the data frame. We can then use this logical vector to subset the data frame and show the duplicate rows. The logical vector is stored in a filter **duplicated_rows** which is used to subset the `finance` data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Show duplicate rows\nduplicated_rows <- finance[duplicated(finance),]\nglimpse(duplicated_rows)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,113\nColumns: 5\n$ participantId <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"…\n$ timestamp     <dttm> 2022-03-01, 2022-03-01, 2022-03-01, 2022-03-01, 2022-03…\n$ category      <chr> \"Shelter\", \"Education\", \"Shelter\", \"Education\", \"Shelter…\n$ amount        <dbl> 554.99, 38.01, 554.99, 38.01, 556.55, 12.81, 554.99, 38.…\n$ month_year    <chr> \"03-2022\", \"03-2022\", \"03-2022\", \"03-2022\", \"03-2022\", \"…\n```\n:::\n:::\n\n\n-   **`unique()`** function is used to remove the duplicate rows form `finance` data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove duplicate rows\nfinance <- unique(finance)\n```\n:::\n\n\n-   Perform a final check to verify that there are no more duplicate using `any()` function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(finance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nThe last thing to do is to create a new column **date** that is in `<date>` format using the `as.Date` function.\n\n-   the paste0() function is used to concatenate \"01-\" with each value in the month_year column. This is because as.Date() requires a complete date in the format \"dd-mm-yyyy\"\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    finance$date <- as.Date(paste0(\"01-\", finance$month_year), format = \"%d-%m-%Y\")\n    ```\n    :::\n\n\n**Other issues**\n\nWhen the `finance` dataset is group-by the **date** variable , it is noticed that the number of distinct participantID who took part in the survey was 1,011 in March 2022 and suddenly reduced to a constant value of 880 from April 2022 onwards. It seems to suggest that there are 131 residents who moved out of the city at the end of March 2022.\n\nIn the code chunk below:\n\n-   dataset is group-by **date** and the distinct count of **participantID** is generated using `n_distinct` function\n\n-   the **missing** dataframe is displayed below using `knitr::kable()` function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_summary <- finance %>%\n  group_by(date) %>% \n  summarise(n_distinct=n_distinct(participantId)) %>% \n  rename(`Number of unique participantId` = n_distinct)\n\nknitr::kable(missing_summary, \"simple\")\n```\n\n::: {.cell-output-display}\ndate          Number of unique participantId\n-----------  -------------------------------\n2022-03-01                              1011\n2022-04-01                               880\n2022-05-01                               880\n2022-06-01                               880\n2022-07-01                               880\n2022-08-01                               880\n2022-09-01                               880\n2022-10-01                               880\n2022-11-01                               880\n2022-12-01                               880\n2023-01-01                               880\n2023-02-01                               880\n:::\n:::\n\n\nSince 11 out of 12 months of records are missing for these 131 residents, we will delete their records from the `finance` dataset.\n\nThe code chunk below does the following:\n\n-   extract the **participantIds** of residents whose records exists in March 22 but not in all April 22 using the `anti-join` function\n\n-   pass the unique **`participantId`** column name as an argument to **`pull()`** and use the **`as.vector()`** function to convert the resulting tibble column to a vector\n\n-   resulting dataframe will only contain **`participantId`**s that are in '2022-03-01' but not in '2022-04-01' onwards. There are 131 of them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_id <- finance %>%\n  filter(date == as.Date('2022-03-01')) %>% # filter for '2022-03-01' date\n  anti_join(finance %>%\n             filter(date == as.Date('2022-04-01')), # filter for '2022-04-01' date\n             by = 'participantId') %>% # anti-join by 'participantId'\n  select(participantId) %>% \n  distinct(participantId)\n\n# extract participantId column as convert this column to vector.\nmissing_id_vector <- as.vector(pull(missing_id, participantId))\n\nmissing_id_vector \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"44\"  \"127\" \"142\" \"154\" \"161\" \"256\" \"262\" \"267\" \"279\" \"285\" \"288\" \"298\"\n [13] \"301\" \"346\" \"352\" \"356\" \"380\" \"382\" \"383\" \"384\" \"392\" \"406\" \"407\" \"509\"\n [25] \"510\" \"512\" \"514\" \"523\" \"526\" \"539\" \"541\" \"553\" \"558\" \"567\" \"568\" \"572\"\n [37] \"574\" \"575\" \"577\" \"580\" \"589\" \"595\" \"599\" \"602\" \"603\" \"604\" \"605\" \"611\"\n [49] \"615\" \"617\" \"621\" \"628\" \"629\" \"634\" \"639\" \"641\" \"643\" \"647\" \"653\" \"655\"\n [61] \"657\" \"658\" \"663\" \"668\" \"670\" \"756\" \"757\" \"760\" \"761\" \"762\" \"768\" \"771\"\n [73] \"773\" \"774\" \"780\" \"785\" \"789\" \"790\" \"791\" \"792\" \"793\" \"794\" \"799\" \"802\"\n [85] \"806\" \"808\" \"816\" \"817\" \"818\" \"824\" \"825\" \"827\" \"828\" \"831\" \"832\" \"834\"\n [97] \"839\" \"842\" \"846\" \"847\" \"853\" \"855\" \"856\" \"858\" \"859\" \"860\" \"862\" \"864\"\n[109] \"867\" \"872\" \"875\" \"876\" \"883\" \"884\" \"885\" \"886\" \"887\" \"892\" \"896\" \"897\"\n[121] \"900\" \"901\" \"902\" \"907\" \"909\" \"911\" \"919\" \"920\" \"923\" \"924\" \"925\"\n```\n:::\n:::\n\n\nNext, we will remove all records of the 131 potentially non-residents from the `finance` dataset .\n\nIn the code chunk below:\n\n-   the **`%in%`** operator is to check if each **`id`** value is contained in the missing_id_vector\n\n-   the negation operator **`!`** ensures the resulting filtered data frame will not contain the rows where the **`id`** values are in missing_id_vector\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance1 <- finance[!finance$participantId %in% missing_id_vector, ]\nfinance1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,509,897 × 6\n   participantId timestamp           category  amount month_year date      \n   <chr>         <dttm>              <chr>      <dbl> <chr>      <date>    \n 1 0             2022-03-01 00:00:00 Wage      2473.  03-2022    2022-03-01\n 2 0             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01\n 3 0             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01\n 4 1             2022-03-01 00:00:00 Wage      2047.  03-2022    2022-03-01\n 5 1             2022-03-01 00:00:00 Shelter    555.  03-2022    2022-03-01\n 6 1             2022-03-01 00:00:00 Education   38.0 03-2022    2022-03-01\n 7 2             2022-03-01 00:00:00 Wage      2437.  03-2022    2022-03-01\n 8 2             2022-03-01 00:00:00 Shelter    557.  03-2022    2022-03-01\n 9 2             2022-03-01 00:00:00 Education   12.8 03-2022    2022-03-01\n10 3             2022-03-01 00:00:00 Wage      2367.  03-2022    2022-03-01\n# ℹ 1,509,887 more rows\n```\n:::\n:::\n\n\nWe will double check that the records of 131 non-residents have been removed from `finance1` dataframe.\n\nIn the code below\n\n-   **`distinct()`** function to extract the distinct **`participantId`** values from **`finance1`**\n\n-   the **`n_distinct()`** function will count the number of distinct **`participantId`** values in the resulting tibble\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinance1 %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 880\n```\n:::\n:::\n\n\n### 2.3.2 ptcp dataset issues:\n\n-   **participantId** should be converted from `<dbl>` format to `<chr>` format\n\n-   **householdSize** should be converted from `<dbl>`{style=\"caret-color: white;\"} format to `<fct>`{style=\"caret-color: white;\"} format. It does not make sense to have 2.5 persons.\n\n-   **age** should be converted from `<dbl>`{style=\"caret-color: white;\"} format to `<int>`{style=\"caret-color: white;\"} format.\n\n-   **educationLevel** should be converted from `<chr>` to `<fct>` . It should also be ordered according to 'Low', 'HighSchoolOrCollege', 'Bachelors' and 'Graduate'.\n\nThe code chunk below does the following:\n\n-   `as.character` and `as.factor` functions are used to convert **participantId** to `<chr>` , **householdSize** to `<fct>` and **age** to `<int>`.\n\n-   `factor(educationLevel, levels=c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")))` not only converts **educationLevel** to factor, but also order the values inside.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert to factor\nptcp <- ptcp %>% mutate(participantId = as.character(participantId))\nptcp <- ptcp %>% mutate(householdSize = as.factor(householdSize))\n\n# Convert educationLevel to factor and order accordingly\nptcp <- ptcp %>% mutate(educationLevel = factor(educationLevel, levels=c(\"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \"Graduate\")))\n\n# convert age to int\nptcp <- ptcp %>% mutate(age = as.integer(age))\n```\n:::\n\n\nThe columns format are all in order now.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ptcp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,011\nColumns: 7\n$ participantId  <chr> \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\",…\n$ householdSize  <fct> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…\n$ haveKids       <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…\n$ age            <int> 36, 25, 35, 21, 43, 32, 26, 27, 20, 35, 48, 27, 34, 18,…\n$ educationLevel <fct> HighSchoolOrCollege, HighSchoolOrCollege, HighSchoolOrC…\n$ interestGroup  <chr> \"H\", \"B\", \"A\", \"I\", \"H\", \"D\", \"I\", \"A\", \"G\", \"D\", \"D\", …\n$ joviality      <dbl> 0.001626703, 0.328086500, 0.393469590, 0.138063446, 0.8…\n```\n:::\n:::\n\n\nUse `distinct()` and `n_distinct()` to check on the number of unique participantIds in `ptcp` table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1011\n```\n:::\n:::\n\n\nCurrently, the `ptcp` table still contain the demographic records of the 131 residents who moved out. Let us remove their records by using similar method used in removing the same records in `financial` table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nptcp1 <- ptcp[!ptcp$participantId %in% missing_id_vector, ]\n\nptcp1 %>% \n  distinct(participantId) %>% \n  n_distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 880\n```\n:::\n:::\n\n\nBoth `finance1` and `ptcp1` tables now contains information about the same number of participantIds.\n\n### 2.3.3 Convert `finance1` table to wide format and perform left outer join with `ptcp1` table.\n\nWe will now convert the `finance1` dataframe from a long to a wide format. The code chunk below does the following:\n\n-   group the data by **participantId** , **date** and **category** using the **`group_by`** function\n\n-   use the `sum` function to calculate the total monthly amount for each **category** per **participantId** per **month**\n\n-   the `pivot_wider` function will convert the **category** column to wide format with total monthly values in the **amount** column.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    finance1_wide<- finance1 %>%\n      group_by(participantId, date, category) %>%\n      summarise(total_amount = sum(amount)) %>%\n      pivot_wider(names_from = category, values_from = total_amount)\n    ```\n    :::\n\n    ::: {.cell}\n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 10,560 × 8\n    # Groups:   participantId, date [10,560]\n       participantId date       Education  Food Recreation Shelter   Wage\n       <chr>         <date>         <dbl> <dbl>      <dbl>   <dbl>  <dbl>\n     1 0             2022-03-01      38.0  268.      349.     555. 11932.\n     2 0             2022-04-01      38.0  266.      219.     555.  8637.\n     3 0             2022-05-01      38.0  265.      383.     555.  9048.\n     4 0             2022-06-01      38.0  257.      466.     555.  9048.\n     5 0             2022-07-01      38.0  270.     1069.     555.  8637.\n     6 0             2022-08-01      38.0  262.      314.     555.  9459.\n     7 0             2022-09-01      38.0  256.      295.     555.  9048.\n     8 0             2022-10-01      38.0  267.       25.0    555.  8637.\n     9 0             2022-11-01      38.0  261       377.     555.  9048.\n    10 0             2022-12-01      38.0  266.      357.     555.  9048.\n    # ℹ 10,550 more rows\n    # ℹ 1 more variable: RentAdjustment <dbl>\n    ```\n    :::\n    :::\n\n\n    ::: callout-note\n    About finance1_wide table\n\n    `finance_wide` is a table that has one row for each unique combination of **participantId** and **month** and one column for each unique category from the former `finance1` table.\n    :::\n\n    The code chunk below performs a left outer join with finance1_wide table (left) and ptcp1 table (right) with join key **participantId**.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    # left outer join\n    finance1_wide_ptcp1 <- left_join(finance1_wide, ptcp1, by = \"participantId\")\n    ```\n    :::\n\n\n    The first 12 rows of the cleansed finance1_wide_ptcp1 is displayed using `knitr::kable()`{style=\"caret-color: white;\"} function. It contains 10,560 rows and 14 columns.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    knitr::kable(head(finance1_wide_ptcp1,12), \"simple\") \n    ```\n    \n    ::: {.cell-output-display}\n    participantId   date          Education     Food   Recreation   Shelter       Wage   RentAdjustment  householdSize   haveKids    age  educationLevel        interestGroup    joviality\n    --------------  -----------  ----------  -------  -----------  --------  ---------  ---------------  --------------  ---------  ----  --------------------  --------------  ----------\n    0               2022-03-01        38.01   268.26       348.68    554.99   11931.95               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-04-01        38.01   265.79       219.42    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-05-01        38.01   264.54       382.99    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-06-01        38.01   256.90       465.67    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-07-01        38.01   270.13      1069.48    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-08-01        38.01   261.76       314.13    554.99    9459.44               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-09-01        38.01   256.04       294.64    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-10-01        38.01   266.67        25.01    554.99    8636.88               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-11-01        38.01   261.00       377.41    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2022-12-01        38.01   265.98       356.69    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2023-01-01        38.01   264.97       209.77    554.99    9048.16               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    0               2023-02-01        38.01   239.05       319.93    554.99    8225.60               NA  3               TRUE         36  HighSchoolOrCollege   H                0.0016267\n    :::\n    :::\n\n\n    # 3 Visualisation\n\n    ## 3.1 EDA\n\n    ### 3.1.1 Interactive Lollipop and line plot of city's monthly total income vs total expenses (high-level view)\n\n    In this exercise, I will explore the dataset from high level and then zoom into interesting patterns (if I can find any =))\n\n    We prepare the data require for the plot. Categorise Education, Food, Recreation, Shelter into **Expenses**. Wage belongs to **Income** category**.**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\"}\n    highlevel <- finance1_wide_ptcp1 %>%\n      group_by(date) %>%\n      summarize(Education = sum(Education, na.rm = TRUE),\n                Food = sum(Food, na.rm = TRUE),\n                Recreation = sum(Recreation, na.rm = TRUE),\n                Shelter = sum(Shelter, na.rm = TRUE),\n                Wage = sum(Wage, na.rm = TRUE),\n                RentAdjustment = sum(RentAdjustment, na.rm = TRUE),\n                ExpenseP = sum(Education, Food, Recreation, Shelter),  #<<<\n                Income = sum(Wage, RentAdjustment),                    #<<<\n                Saving = Income - ExpenseP,                            #<<<\n                Expense = ExpenseP * -1                                #<<<\n                )\n    head(highlevel,5)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 5 × 11\n      date       Education    Food Recreation Shelter   Wage RentAdjustment ExpenseP\n      <date>         <dbl>   <dbl>      <dbl>   <dbl>  <dbl>          <dbl>    <dbl>\n    1 2022-03-01    11424. 320126.    649580. 631623. 6.07e6         53504. 1612753.\n    2 2022-04-01    11424. 304282.    389688. 559919. 3.47e6          1429. 1265312.\n    3 2022-05-01    11424. 313538.    336413. 558451. 3.62e6             0  1219825.\n    4 2022-06-01    11424. 302893.    314804. 558451. 3.61e6             0  1187571.\n    5 2022-07-01    11424. 313803.    329608. 558451. 3.49e6             0  1213285.\n    # ℹ 3 more variables: Income <dbl>, Saving <dbl>, Expense <dbl>\n    ```\n    :::\n    :::\n\n\n**Design Considerations:**\n\nI have ensured inking concepts (key words, lines, fill are darker) and gridlines are lighter in shade. In order to see the end of the geom_segments, the opacity of the geom_point objects are reduced via `alpha` argument. The vertical gridlines are disabled to avoid confusion with the vertical geom_segment lines.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(scales)\nh<-ggplot(highlevel) +\n  geom_segment(aes(x=date, \n                   xend=date, \n                   y=Income, \n                   yend=Expense, \n                   color=\"grey20\"), \n               size=0.6, \n               alpha= 0.9) +\n  geom_point(aes(x=date,\n                 y=Income, \n                 color=\"Income\", \n                 shape='Income', \n                 size = Income))+\n  geom_point(aes(x=date, \n                 y=Expense, \n                 color=\"Expense\", \n                 shape='Expense', \n                 size = -Expense)) +\n  geom_line(aes(x=date, \n                y=Saving), \n            color=rgb(0.2,0.2,0.9,0.9), \n            size=1) +\n  geom_text(aes(x=as.Date(\"2022-04-01\"), \n                y=max(Saving), \n                label=\"Saving\"),\n            hjust=1, \n            vjust=1, \n            color=rgb(0.2,0.2,0.9,0.5), \n            size=3.5) +\n  geom_hline(yintercept=0, color=\"black\", size=0.2) +\n  \n  # colours\n  scale_color_manual(values = c(\"Income\" = rgb(0.2,0.7,0.1,0.9), \n                                \"Expense\" = rgb(0.7,0.2,0.1,0.9))) +\n  scale_shape_manual(values = c(\"Income\" = 16, \"Expense\" = 16)) +\n  labs(color=\"\", shape=\"\") +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  \n  # axes scale control\n  scale_x_date(date_breaks = '1 month',date_labels = \"%b %Y\") +\n  scale_y_continuous(limits = c(-2000000, 6500000), \n                     breaks=seq(-2000000, 6500000, 1000000), \n                     labels= comma) +\n  \n  theme_light() +\n  theme(axis.line.y = element_line(color=\"black\", size=0.2, linetype=\"solid\"),\n        panel.grid.major.x = element_blank(),\n        panel.border = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.title.y=element_text(angle = 0, vjust=0.9),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  \n  \n  xlab(\"\") +\n  ylab(\"Amount\") +\n  ggtitle('City monthly total income, total expense and total savings')\n\nggplotly(h,\n         tooltip = c('labels','x','y'))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-fa623ec4901d5d619281\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fa623ec4901d5d619281\">{\"x\":{\"data\":[{\"x\":[19052,19052,null,19083,19083,null,19113,19113,null,19144,19144,null,19174,19174,null,19205,19205,null,19236,19236,null,19266,19266,null,19297,19297,null,19327,19327,null,19358,19358,null,19389,19389],\"y\":[6122113.9,-1612753.07,null,3470185.99,-1265312.08,null,3623068.09,-1219825.4,null,3608883.31,-1187570.94,null,3485799.42,-1213284.94,null,3763807.89,-1189655.46,null,3610504.14,-1174641.52,null,3483352.75,-1210151.18,null,3607156.48,-1160991.35,null,3627932.32,-1199574.64,null,3623061.39,-1194704.27,null,3292643.75,-1123458.51],\"text\":[\"date: 2022-03-01<br />Income: 6122114\",\"date: 2022-03-01<br />Income: 6122114\",null,\"date: 2022-04-01<br />Income: 3470186\",\"date: 2022-04-01<br />Income: 3470186\",null,\"date: 2022-05-01<br />Income: 3623068\",\"date: 2022-05-01<br />Income: 3623068\",null,\"date: 2022-06-01<br />Income: 3608883\",\"date: 2022-06-01<br />Income: 3608883\",null,\"date: 2022-07-01<br />Income: 3485799\",\"date: 2022-07-01<br />Income: 3485799\",null,\"date: 2022-08-01<br />Income: 3763808\",\"date: 2022-08-01<br />Income: 3763808\",null,\"date: 2022-09-01<br />Income: 3610504\",\"date: 2022-09-01<br />Income: 3610504\",null,\"date: 2022-10-01<br />Income: 3483353\",\"date: 2022-10-01<br />Income: 3483353\",null,\"date: 2022-11-01<br />Income: 3607156\",\"date: 2022-11-01<br />Income: 3607156\",null,\"date: 2022-12-01<br />Income: 3627932\",\"date: 2022-12-01<br />Income: 3627932\",null,\"date: 2023-01-01<br />Income: 3623061\",\"date: 2023-01-01<br />Income: 3623061\",null,\"date: 2023-02-01<br />Income: 3292644\",\"date: 2023-02-01<br />Income: 3292644\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(127,127,127,0.9)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[6122113.9,3470185.99,3623068.09,3608883.31,3485799.42,3763807.89,3610504.14,3483352.75,3607156.48,3627932.32,3623061.39,3292643.75],\"text\":[\"date: 2022-03-01<br />Income: 6122114\",\"date: 2022-04-01<br />Income: 3470186\",\"date: 2022-05-01<br />Income: 3623068\",\"date: 2022-06-01<br />Income: 3608883\",\"date: 2022-07-01<br />Income: 3485799\",\"date: 2022-08-01<br />Income: 3763808\",\"date: 2022-09-01<br />Income: 3610504\",\"date: 2022-10-01<br />Income: 3483353\",\"date: 2022-11-01<br />Income: 3607156\",\"date: 2022-12-01<br />Income: 3627932\",\"date: 2023-01-01<br />Income: 3623061\",\"date: 2023-02-01<br />Income: 3292644\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(51,179,26,0.902)\",\"opacity\":1,\"size\":[22.6771653543307,16.7278126078653,17.1429289198985,17.1049576703205,16.770815468108,17.5139885787233,17.1093019451494,16.7640862046622,17.1003277272347,17.1559251624572,17.1429110101317,16.2283778003363],\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(51,179,26,0.902)\"}},\"hoveron\":\"points\",\"name\":\"Income\",\"legendgroup\":\"Income\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[-1612753.07,-1265312.08,-1219825.4,-1187570.94,-1213284.94,-1189655.46,-1174641.52,-1210151.18,-1160991.35,-1199574.64,-1194704.27,-1123458.51],\"text\":[\"date: 2022-03-01<br />Expense: -1612753\",\"date: 2022-04-01<br />Expense: -1265312\",\"date: 2022-05-01<br />Expense: -1219825\",\"date: 2022-06-01<br />Expense: -1187571\",\"date: 2022-07-01<br />Expense: -1213285\",\"date: 2022-08-01<br />Expense: -1189655\",\"date: 2022-09-01<br />Expense: -1174642\",\"date: 2022-10-01<br />Expense: -1210151\",\"date: 2022-11-01<br />Expense: -1160991\",\"date: 2022-12-01<br />Expense: -1199575\",\"date: 2023-01-01<br />Expense: -1194704\",\"date: 2023-02-01<br />Expense: -1123459\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(179,51,26,0.902)\",\"opacity\":1,\"size\":[9.69195897202369,6.96299972571424,6.40341284320808,5.91971613273669,6.31280637814119,5.95423035125546,5.69177387711998,6.26822505882851,5.41704764518651,6.11147775959389,6.03563840790087,3.77952755905512],\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(179,51,26,0.902)\"}},\"hoveron\":\"points\",\"name\":\"Expense\",\"legendgroup\":\"Expense\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[4509360.83,2204873.91,2403242.69,2421312.37,2272514.48,2574152.43,2435862.62,2273201.57,2446165.13,2428357.68,2428357.12,2169185.24],\"text\":[\"date: 2022-03-01<br />Saving: 4509361\",\"date: 2022-04-01<br />Saving: 2204874\",\"date: 2022-05-01<br />Saving: 2403243\",\"date: 2022-06-01<br />Saving: 2421312\",\"date: 2022-07-01<br />Saving: 2272514\",\"date: 2022-08-01<br />Saving: 2574152\",\"date: 2022-09-01<br />Saving: 2435863\",\"date: 2022-10-01<br />Saving: 2273202\",\"date: 2022-11-01<br />Saving: 2446165\",\"date: 2022-12-01<br />Saving: 2428358\",\"date: 2023-01-01<br />Saving: 2428357\",\"date: 2023-02-01<br />Saving: 2169185\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":3.77952755905512,\"color\":\"rgba(51,51,230,0.902)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083],\"y\":[4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83,4509360.83],\"text\":[\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\",\"Saving\"],\"hovertext\":[\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />max(Saving): 4509361\"],\"textfont\":{\"size\":13.2283464566929,\"color\":\"rgba(51,51,230,0.502)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19035.15,19405.85],\"y\":[0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":0.755905511811024,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.7625570776256,\"r\":7.30593607305936,\"b\":39.2002401882598,\"l\":113.24200913242},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"title\":{\"text\":\"City monthly total income, total expense and total savings\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.5342465753425},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19035.15,19405.85],\"tickmode\":\"array\",\"ticktext\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"tickvals\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"categoryorder\":\"array\",\"categoryarray\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2425000,6925000],\"tickmode\":\"array\",\"ticktext\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"tickvals\":[-2000000,-1000000,0,1000000,2000000,3000000,4000000,5000000,6000000],\"categoryorder\":\"array\",\"categoryarray\":[\"-2,000,000\",\"-1,000,000\",\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.33208800332088,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.265670402656704,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.33208800332088,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Amount\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"<br />Income\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"239433a74ed9\":{\"x\":{},\"y\":{},\"xend\":{},\"yend\":{},\"colour\":{},\"type\":\"scatter\"},\"239472cf5390\":{\"x\":{},\"y\":{},\"colour\":{},\"shape\":{},\"size\":{}},\"23944d7f1a50\":{\"x\":{},\"y\":{},\"colour\":{},\"shape\":{},\"size\":{}},\"2394147f4a8d\":{\"x\":{},\"y\":{}},\"23945738248a\":{\"x\":{},\"y\":{},\"label\":{}},\"23943bf1516f\":{\"yintercept\":{}}},\"cur_data\":\"239433a74ed9\",\"visdat\":{\"239433a74ed9\":[\"function (y) \",\"x\"],\"239472cf5390\":[\"function (y) \",\"x\"],\"23944d7f1a50\":[\"function (y) \",\"x\"],\"2394147f4a8d\":[\"function (y) \",\"x\"],\"23945738248a\":[\"function (y) \",\"x\"],\"23943bf1516f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n::: callout-note\nThe first three arguments of `rgb()` are (red, green, and blue) and the last argument (alpha)\n:::\n\nThe plot above shows an obvious spike in Income and Expenses in the month of March. We will zoom into the different categories of expenses below.\n\n### 3.1.2 Zooming into Interactive Line charts of income and expenditures by month\n\n**Design considerations:**\n\nDue to the large difference in values between wage and other expenses, I have separated income and expense into two graphs. This will enable use to visualise the values of the expense clearly. For the second line plot, the type of expenses are directly labelled beside the lines instead of using a legend as it is more user-friendly this way.\n\nThere are several manual adjustments that I made to the graph and the key ones are shown below:\n\n-   the **`color`** aesthetic within each **`geom_line`** maps the name of the variable to a specific color. Then, the **`scale_color_manual`** function is used to assign the desired colors to each variable name.\n\n-   **`scale_x_date()`** is used to display all the values in the x-axis with the date format \"%Y-%m\".\n\n-   **`scale_y_continuous()`** with **`labels = comma`** is used to format the y-axis labels with commas, otherwise it will appear as index notation.\n\n-   **`theme_light()`** is used to set the plot background to white and remove the grid lines.\n\n-   **`element_line()`** is used to increase the axis line width.\n\n-   **`legend.position = \"none\"`** is used to remove the legend since they are manually labelled using `geom_text`.\n\n-   **`legend.title = element_blank()`** is used to remove the legend title.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(scales)\n\nq1<-highlevel %>%\n  ggplot(aes(x = date)) +\n  geom_line(aes(y = Wage, color = \"Red\", linetype = \"Wage\"), size = 1) +\n\n  \n  # annotating the plot\n  geom_text(aes(x=as.Date(\"2022-04-01\"),\n                y=6000000,\n                label=\"High wages \\nobserved in \\nMarch\"), \n            hjust=1, vjust=1, color='black', size=2.5) +\n  geom_text(aes(x=as.Date(\"2022-12-01\"), y=3800000, label=\"Wage\"),\n            hjust=1, vjust=1,color='red', size=2.5) +\n\n\n  # scale control\n  labs(x = \"Month\", y = \"Amount\") +\n  scale_x_date(date_breaks = '1 month',date_labels = \"%b %Y\") +\n  scale_y_continuous(limits = c(0, 6500000), breaks=seq(0, 6500000, 1000000),\n                     labels= comma) +\n  \n  theme_light(base_size = 12) +\n  theme(axis.title = element_text(size = 10 , face = \"bold\"),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        axis.line = element_line(size = 1),\n        panel.grid.major.x = element_blank(),\n        panel.grid.minor = element_line(colour='black'),\n        panel.border = element_blank(),\n        legend.position = \"none\",\n        legend.title = element_blank()) +\n\n\n  labs(title= 'Cumulative Income across Months',\n       x='Month',\n       y='Amount')\n\nggplotly(q1,tooltip = c('labels','x','y'))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-883ae0d3d8bcb0a9a74e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-883ae0d3d8bcb0a9a74e\">{\"x\":{\"data\":[{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[6068610.35,3468756.75,3623068.09,3608883.31,3485799.42,3763807.89,3610504.14,3483352.75,3607156.48,3627932.32,3623061.39,3292643.75],\"text\":[\"date: 2022-03-01<br />Wage: 6068610\",\"date: 2022-04-01<br />Wage: 3468757\",\"date: 2022-05-01<br />Wage: 3623068\",\"date: 2022-06-01<br />Wage: 3608883\",\"date: 2022-07-01<br />Wage: 3485799\",\"date: 2022-08-01<br />Wage: 3763808\",\"date: 2022-09-01<br />Wage: 3610504\",\"date: 2022-10-01<br />Wage: 3483353\",\"date: 2022-11-01<br />Wage: 3607156\",\"date: 2022-12-01<br />Wage: 3627932\",\"date: 2023-01-01<br />Wage: 3623061\",\"date: 2023-02-01<br />Wage: 3292644\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":3.77952755905512,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"(Red,Wage)\",\"legendgroup\":\"(Red,Wage)\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083,19083],\"y\":[6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000,6000000],\"text\":[\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\",\"High wages <br />observed in <br />March\"],\"hovertext\":[\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\",\"as.Date(\\\"2022-04-01\\\"): 2022-04-01<br />y: 6e+06\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],\"y\":[3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000,3800000],\"text\":[\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\",\"Wage\"],\"hovertext\":[\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 3800000\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(255,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":46.2864259028643,\"r\":7.97011207970112,\"b\":57.1982804131844,\"l\":85.0145288501453},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.9402241594022},\"title\":{\"text\":\"Cumulative Income across Months\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":19.1282689912827},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19035.15,19405.85],\"tickmode\":\"array\",\"ticktext\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"tickvals\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"categoryorder\":\"array\",\"categoryarray\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.98505603985056,\"tickwidth\":0.362277821804596,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":1.32835201328352,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"<b> Month <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-325000,6825000],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"tickvals\":[0,1000000,2000000,3000000,4000000,5000000,6000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1,000,000\",\"2,000,000\",\"3,000,000\",\"4,000,000\",\"5,000,000\",\"6,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.98505603985056,\"tickwidth\":0.362277821804596,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":1.32835201328352,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.362277821804596,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"<b> Amount <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":2.06156048675734,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":12.7521793275218}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"239440285662\":{\"x\":{},\"y\":{},\"colour\":{},\"linetype\":{},\"type\":\"scatter\"},\"239414156911\":{\"x\":{},\"y\":{},\"label\":{}},\"239456ce587f\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"239440285662\",\"visdat\":{\"239440285662\":[\"function (y) \",\"x\"],\"239414156911\":[\"function (y) \",\"x\"],\"239456ce587f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nq2<-highlevel %>%\n  ggplot(aes(x = date)) +\n  geom_line(aes(y = Education, color = \"Education\"), size = 0.7,,alpha=0.8) +\n  geom_line(aes(y = Recreation, color = \"Recreation\"), size = 0.7,,alpha=0.8) +\n  geom_line(aes(y = Food, color = \"Food\"), size = 0.7, alpha=0.8) +\n  geom_line(aes(y = Shelter, color = \"Shelter\"), size = 0.7,alpha=0.8) +\n  \n  scale_color_manual(values = c(\"Education\" = \"green\", \n                                \"Recreation\" = \"purple\",\n                                \"Food\" = \"orange\", \n                                \"Shelter\" = \"blue\")) +\n\n  \n  # annotating the plot\n  geom_text(aes(x=as.Date(\"2022-05-01\"), y=630000, \n                label=\"Higher recreational and shelter \\nspendings in March\"), \n            hjust=1, vjust=1, color='grey10',size=2.5) +\n  geom_text(aes(x=as.Date(\"2022-12-01\"), y=600000, label=\"Shelter\"), \n            hjust=1, vjust=1, color='blue', size=2.5) +\n  geom_text(aes(x=as.Date(\"2022-12-01\"), y=280000, label=\"Recreational\"), \n            hjust=1, vjust=1, color='purple', size=2.5) +\n  geom_text(aes(x=as.Date(\"2022-12-01\"), y=380000, label=\"Food\"), \n            hjust=1, vjust=1, color='orange', size=2.5) +\n  geom_text(aes(x=as.Date(\"2022-12-01\"), y=50000, label=\"Education\"), \n            hjust=1, vjust=1, color='green', size=2.5) +\n  \n  # chart control\n  labs(x = \"Month\", y = \"Amount\") +\n  scale_x_date(date_breaks = '1 month',date_labels = \"%b %Y\") +\n  scale_y_continuous(limits = c(0, 650000), \n                     breaks=seq(0, 650000, 100000), \n                     labels= comma) +\n  \n  theme_light(base_size = 12) +\n  theme(axis.title = element_text(size = 10 , face = \"bold\"),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        axis.line = element_line(size = 1),\n        panel.grid.major.x = element_blank(),\n        panel.grid.minor = element_line(colour='black'),\n        panel.border = element_blank(),\n        legend.position = \"none\",\n        legend.title = element_blank(),\n        legend.text = element_text(size = 5)) + \n\n  labs(title= \"Cumulative City Expenses across Months\",\n       x='Month',\n       y='Amount')\n\nggplotly(q2,tooltip = c('labels','x','y'))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-8163e1e2d61c4287c40b\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8163e1e2d61c4287c40b\">{\"x\":{\"data\":[{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61,11423.61],\"text\":[\"date: 2022-03-01<br />Education: 11423.61\",\"date: 2022-04-01<br />Education: 11423.61\",\"date: 2022-05-01<br />Education: 11423.61\",\"date: 2022-06-01<br />Education: 11423.61\",\"date: 2022-07-01<br />Education: 11423.61\",\"date: 2022-08-01<br />Education: 11423.61\",\"date: 2022-09-01<br />Education: 11423.61\",\"date: 2022-10-01<br />Education: 11423.61\",\"date: 2022-11-01<br />Education: 11423.61\",\"date: 2022-12-01<br />Education: 11423.61\",\"date: 2023-01-01<br />Education: 11423.61\",\"date: 2023-02-01<br />Education: 11423.61\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.64566929133858,\"color\":\"rgba(0,255,0,0.8)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Education\",\"legendgroup\":\"Education\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[649580.2,389688.19,336412.8,314803.52,329607.52,306957.14,301905.75,326716.47,288286.21,316614.56,311575.03,271121.58],\"text\":[\"date: 2022-03-01<br />Recreation: 649580.2\",\"date: 2022-04-01<br />Recreation: 389688.2\",\"date: 2022-05-01<br />Recreation: 336412.8\",\"date: 2022-06-01<br />Recreation: 314803.5\",\"date: 2022-07-01<br />Recreation: 329607.5\",\"date: 2022-08-01<br />Recreation: 306957.1\",\"date: 2022-09-01<br />Recreation: 301905.8\",\"date: 2022-10-01<br />Recreation: 326716.5\",\"date: 2022-11-01<br />Recreation: 288286.2\",\"date: 2022-12-01<br />Recreation: 316614.6\",\"date: 2023-01-01<br />Recreation: 311575.0\",\"date: 2023-02-01<br />Recreation: 271121.6\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.64566929133858,\"color\":\"rgba(160,32,240,0.8)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Recreation\",\"legendgroup\":\"Recreation\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[320126.03,304281.62,313538.21,302893.03,313803.03,312823.93,302861.38,313560.32,302830.75,313085.69,313254.85,282462.54],\"text\":[\"date: 2022-03-01<br />Food: 320126.0\",\"date: 2022-04-01<br />Food: 304281.6\",\"date: 2022-05-01<br />Food: 313538.2\",\"date: 2022-06-01<br />Food: 302893.0\",\"date: 2022-07-01<br />Food: 313803.0\",\"date: 2022-08-01<br />Food: 312823.9\",\"date: 2022-09-01<br />Food: 302861.4\",\"date: 2022-10-01<br />Food: 313560.3\",\"date: 2022-11-01<br />Food: 302830.8\",\"date: 2022-12-01<br />Food: 313085.7\",\"date: 2023-01-01<br />Food: 313254.8\",\"date: 2023-02-01<br />Food: 282462.5\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.64566929133858,\"color\":\"rgba(255,165,0,0.8)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Food\",\"legendgroup\":\"Food\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"y\":[631623.23,559918.66,558450.78,558450.78,558450.78,558450.78,558450.78,558450.78,558450.78,558450.78,558450.78,558450.78],\"text\":[\"date: 2022-03-01<br />Shelter: 631623.2\",\"date: 2022-04-01<br />Shelter: 559918.7\",\"date: 2022-05-01<br />Shelter: 558450.8\",\"date: 2022-06-01<br />Shelter: 558450.8\",\"date: 2022-07-01<br />Shelter: 558450.8\",\"date: 2022-08-01<br />Shelter: 558450.8\",\"date: 2022-09-01<br />Shelter: 558450.8\",\"date: 2022-10-01<br />Shelter: 558450.8\",\"date: 2022-11-01<br />Shelter: 558450.8\",\"date: 2022-12-01<br />Shelter: 558450.8\",\"date: 2023-01-01<br />Shelter: 558450.8\",\"date: 2023-02-01<br />Shelter: 558450.8\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.64566929133858,\"color\":\"rgba(0,0,255,0.8)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Shelter\",\"legendgroup\":\"Shelter\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19113,19113,19113,19113,19113,19113,19113,19113,19113,19113,19113,19113],\"y\":[630000,630000,630000,630000,630000,630000,630000,630000,630000,630000,630000,630000],\"text\":[\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\",\"Higher recreational and shelter <br />spendings in March\"],\"hovertext\":[\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\",\"as.Date(\\\"2022-05-01\\\"): 2022-05-01<br />y: 630000\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(26,26,26,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],\"y\":[600000,600000,600000,600000,600000,600000,600000,600000,600000,600000,600000,600000],\"text\":[\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\",\"Shelter\"],\"hovertext\":[\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 6e+05\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(0,0,255,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],\"y\":[280000,280000,280000,280000,280000,280000,280000,280000,280000,280000,280000,280000],\"text\":[\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\",\"Recreational\"],\"hovertext\":[\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 280000\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(160,32,240,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],\"y\":[380000,380000,380000,380000,380000,380000,380000,380000,380000,380000,380000,380000],\"text\":[\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\",\"Food\"],\"hovertext\":[\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 380000\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(255,165,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327,19327],\"y\":[50000,50000,50000,50000,50000,50000,50000,50000,50000,50000,50000,50000],\"text\":[\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\",\"Education\"],\"hovertext\":[\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\",\"as.Date(\\\"2022-12-01\\\"): 2022-12-01<br />y: 50000\"],\"textfont\":{\"size\":9.4488188976378,\"color\":\"rgba(0,255,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":46.2864259028643,\"r\":7.97011207970112,\"b\":57.1982804131844,\"l\":71.7310087173101},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.9402241594022},\"title\":{\"text\":\"Cumulative City Expenses across Months\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":19.1282689912827},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19035.15,19405.85],\"tickmode\":\"array\",\"ticktext\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"tickvals\":[19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389],\"categoryorder\":\"array\",\"categoryarray\":[\"Mar 2022\",\"Apr 2022\",\"May 2022\",\"Jun 2022\",\"Jul 2022\",\"Aug 2022\",\"Sep 2022\",\"Oct 2022\",\"Nov 2022\",\"Dec 2022\",\"Jan 2023\",\"Feb 2023\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.98505603985056,\"tickwidth\":0.362277821804596,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":1.32835201328352,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"<b> Month <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-32500,682500],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"100,000\",\"200,000\",\"300,000\",\"400,000\",\"500,000\",\"600,000\"],\"tickvals\":[0,100000,200000,300000,400000,500000,600000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"100,000\",\"200,000\",\"300,000\",\"400,000\",\"500,000\",\"600,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(179,179,179,1)\",\"ticklen\":3.98505603985056,\"tickwidth\":0.362277821804596,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":1.32835201328352,\"showgrid\":true,\"gridcolor\":\"rgba(222,222,222,1)\",\"gridwidth\":0.362277821804596,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"<b> Amount <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":2.06156048675734,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":6.6417600664176}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"23946a4b7351\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"239473595e9c\":{\"x\":{},\"y\":{},\"colour\":{}},\"23941b7c27c7\":{\"x\":{},\"y\":{},\"colour\":{}},\"23946732128f\":{\"x\":{},\"y\":{},\"colour\":{}},\"239411656a66\":{\"x\":{},\"y\":{},\"label\":{}},\"239472fb2ec5\":{\"x\":{},\"y\":{},\"label\":{}},\"239447c41708\":{\"x\":{},\"y\":{},\"label\":{}},\"239443fc5216\":{\"x\":{},\"y\":{},\"label\":{}},\"239446bc4868\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"23946a4b7351\",\"visdat\":{\"23946a4b7351\":[\"function (y) \",\"x\"],\"239473595e9c\":[\"function (y) \",\"x\"],\"23941b7c27c7\":[\"function (y) \",\"x\"],\"23946732128f\":[\"function (y) \",\"x\"],\"239411656a66\":[\"function (y) \",\"x\"],\"239472fb2ec5\":[\"function (y) \",\"x\"],\"239447c41708\":[\"function (y) \",\"x\"],\"239443fc5216\":[\"function (y) \",\"x\"],\"239446bc4868\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nFrom both plots above, March seems to be an exciting month where there is several anomalies observed. There are unusual spikes in wage, recreational and shelter spending.\n\n### 3.1.3 Interactive Heatmap of annual recreation spending and joviality index\n\nCreate another table **annual** that contains aggregated amounts of income and expenses per participant.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nannual <- finance1_wide_ptcp1 %>% \n  group_by(participantId, householdSize, haveKids, educationLevel, interestGroup, joviality) %>% \n  summarize(Education = sum(Education, na.rm = TRUE),\n            Food = sum(Food, na.rm = TRUE),\n            Recreation = sum(Recreation, na.rm = TRUE),\n            Shelter = sum(Shelter, na.rm = TRUE),\n            Wage = sum(Wage, na.rm = TRUE),\n            RentAdjustment = sum(RentAdjustment, na.rm = TRUE)) \n```\n:::\n\n\n::: callout-note\nNote that the **`na.rm = TRUE`** argument is used in the **`sum`** function to handle missing values in the columns during aggregation.\n:::\n\nNext, prepare the data needed to generate a heatmap of annual recreational spendings by interest group and education level.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nheat <- annual %>% \n  group_by(educationLevel, interestGroup) %>% \n  summarise(recre_median=median(Recreation),\n            jov_median = median(joviality))\n```\n:::\n\n\nWe are ready to plot the heatmap.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrecre <- ggplot(heat, aes(x = educationLevel)) +\n  geom_tile_interactive(aes(y = interestGroup,\n                            fill = recre_median,\n                            tooltip=recre_median),\n                        color = \"black\",\n                        lwd = 0.2,\n                        linetype = 1) +\n  scale_fill_gradient(low = \"white\", high = \"blue\") +\n  labs(x = \"Education  level\", y = \"Interest Group\", fill = \"Recreational (median)\") +\n  coord_fixed() +\n  theme_few() +\n  theme(panel.border = element_blank(),\n        panel.grid.major = element_blank(),\n        axis.title.y=element_text(angle = 0,\n                                  vjust =0.9,\n                                  size = 10,\n                                  face='bold'),\n        axis.title.x=element_text(size = 10,\n                                   face='bold'),\n        axis.text.x = element_text(angle = 45,\n                                   hjust = 1,\n                                   size = 10),\n        legend.key.size = unit(0.35, \"cm\"),\n        legend.title = element_text(size = 8,\n                                    face='bold'),\n        legend.text = element_text(size=8),\n        plot.title = element_text(size = 12,\n                                  face='bold')) +\n  labs(title = 'Annual Recreation spending')\n\n\njov <- ggplot(heat, aes(x = educationLevel)) +\n  geom_tile_interactive(aes(y = interestGroup,\n                            fill = jov_median,\n                            tooltip=jov_median),\n                        color = \"black\",\n                        lwd = 0.2,\n                        linetype = 1) +\n  scale_fill_gradient(low = \"white\", high = \"orange\") +\n  labs(x = \"Education  level\", y = \"Interest Group\", fill = \"Joviality Index (median)\") +\n  coord_fixed() +\n  theme_few() +\n  theme(panel.border = element_blank(),\n        panel.grid.major = element_blank(),\n        axis.title.y=element_text(angle = 0,\n                                  vjust =0.9,\n                                  size = 10,\n                                  face='bold'),\n        axis.title.x=element_text(size = 10,\n                                   face='bold'),\n        axis.text.x = element_text(angle = 45,\n                                   hjust = 1,\n                                   size = 10),\n        legend.key.size = unit(0.35, \"cm\"),\n        legend.title = element_text(size = 8,\n                                    face='bold'),\n        legend.text = element_text(size=8),\n        plot.title = element_text(size = 12,\n                                  face='bold')) +\n  labs(title = 'Joviality Index')\n\ngirafe(code = print(recre + jov),         \n       width_svg = 8) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"girafe html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-7a2b3e314b7585dd8376\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7a2b3e314b7585dd8376\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='img' id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d' viewBox='0 0 576 360'>\\n <defs id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_defs'>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c1'>\\n   <rect x='0' y='0' width='576' height='360'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c2'>\\n   <rect x='0' y='23.11' width='576' height='313.79'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c3'>\\n   <rect x='5.48' y='28.58' width='278.96' height='302.83'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c4'>\\n   <rect x='96.2' y='51.66' width='74.76' height='181.56'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c5'>\\n   <rect x='284.44' y='28.58' width='286.08' height='302.83'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c6'>\\n   <rect x='375.15' y='51.66' width='74.76' height='181.56'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c1)'>\\n   <rect x='0' y='0' width='576' height='360' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c2)'>\\n   <rect x='0' y='23.11' width='576' height='313.79' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c3)'>\\n   <rect x='5.48' y='28.58' width='278.96' height='302.83' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c4)'>\\n   <rect x='96.2' y='51.66' width='74.76' height='181.56' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e1' x='97.98' y='213.64' width='17.8' height='17.8' fill='#AD84FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5198.665'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e2' x='97.98' y='195.84' width='17.8' height='17.8' fill='#9063FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5647.925'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e3' x='97.98' y='178.04' width='17.8' height='17.8' fill='#8558FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5798.17'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e4' x='97.98' y='160.24' width='17.8' height='17.8' fill='#BB95FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4952.17'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e5' x='97.98' y='142.44' width='17.8' height='17.8' fill='#D0B3FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4542.625'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e6' x='97.98' y='124.64' width='17.8' height='17.8' fill='#D3B7FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4496.72'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e7' x='97.98' y='106.84' width='17.8' height='17.8' fill='#D3B6FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4498.43'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e8' x='97.98' y='89.04' width='17.8' height='17.8' fill='#D3B6FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4499.705'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e9' x='97.98' y='71.24' width='17.8' height='17.8' fill='#FCFAFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='3580.5'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e10' x='97.98' y='53.44' width='17.8' height='17.8' fill='#0000FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='6669.08'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e11' x='115.78' y='213.64' width='17.8' height='17.8' fill='#8F62FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5664.355'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e12' x='115.78' y='195.84' width='17.8' height='17.8' fill='#CEB0FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4581.7'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e13' x='115.78' y='178.04' width='17.8' height='17.8' fill='#EBDCFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='3984.21'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e14' x='115.78' y='160.24' width='17.8' height='17.8' fill='#9C70FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5462.73'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e15' x='115.78' y='142.44' width='17.8' height='17.8' fill='#AC83FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5207.23'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e16' x='115.78' y='124.64' width='17.8' height='17.8' fill='#A277FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5372.365'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e17' x='115.78' y='106.84' width='17.8' height='17.8' fill='#C19EFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4836.75'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e18' x='115.78' y='89.04' width='17.8' height='17.8' fill='#CCADFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4630.21'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e19' x='115.78' y='71.24' width='17.8' height='17.8' fill='#DFC9FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4248.785'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e20' x='115.78' y='53.44' width='17.8' height='17.8' fill='#B189FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5125.14'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e21' x='133.58' y='213.64' width='17.8' height='17.8' fill='#AF86FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5161.42'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e22' x='133.58' y='195.84' width='17.8' height='17.8' fill='#B088FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5143.35'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e23' x='133.58' y='178.04' width='17.8' height='17.8' fill='#7B4FFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5919.61'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e24' x='133.58' y='160.24' width='17.8' height='17.8' fill='#CCACFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4634.84'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e25' x='133.58' y='142.44' width='17.8' height='17.8' fill='#9F74FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5415.315'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e26' x='133.58' y='124.64' width='17.8' height='17.8' fill='#B088FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5141.755'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e27' x='133.58' y='106.84' width='17.8' height='17.8' fill='#AD84FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5195.845'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e28' x='133.58' y='89.04' width='17.8' height='17.8' fill='#D3B7FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4488.14'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e29' x='133.58' y='71.24' width='17.8' height='17.8' fill='#C09CFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4858.5'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e30' x='133.58' y='53.44' width='17.8' height='17.8' fill='#D3B6FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4500.375'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e31' x='151.38' y='213.64' width='17.8' height='17.8' fill='#B38BFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5093.365'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e32' x='151.38' y='195.84' width='17.8' height='17.8' fill='#B790FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5023.98'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e33' x='151.38' y='178.04' width='17.8' height='17.8' fill='#FFFFFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='3519.44'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e34' x='151.38' y='160.24' width='17.8' height='17.8' fill='#CCACFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4639.44'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e35' x='151.38' y='142.44' width='17.8' height='17.8' fill='#A97FFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5268.365'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e36' x='151.38' y='124.64' width='17.8' height='17.8' fill='#764AFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5979.14'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e37' x='151.38' y='106.84' width='17.8' height='17.8' fill='#DCC4FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4307.01'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e38' x='151.38' y='89.04' width='17.8' height='17.8' fill='#9B6FFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='5486.945'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e39' x='151.38' y='71.24' width='17.8' height='17.8' fill='#C8A7FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4705.4'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e40' x='151.38' y='53.44' width='17.8' height='17.8' fill='#C4A1FF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='4791.47'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c1)'>\\n   <text x='84.42' y='225.97' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>A<\\/text>\\n   <text x='84.42' y='208.17' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>B<\\/text>\\n   <text x='83.89' y='190.37' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>C<\\/text>\\n   <text x='83.89' y='172.57' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>D<\\/text>\\n   <text x='84.42' y='154.77' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>E<\\/text>\\n   <text x='84.96' y='136.97' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>F<\\/text>\\n   <text x='83.36' y='119.17' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>G<\\/text>\\n   <text x='83.89' y='101.37' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>H<\\/text>\\n   <text x='88.15' y='83.57' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>I<\\/text>\\n   <text x='86.02' y='65.77' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>J<\\/text>\\n   <polyline points='93.21,222.54 96.20,222.54' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,204.74 96.20,204.74' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,186.94 96.20,186.94' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,169.14 96.20,169.14' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,151.34 96.20,151.34' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,133.54 96.20,133.54' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,115.74 96.20,115.74' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,97.94 96.20,97.94' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,80.14 96.20,80.14' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='93.21,62.34 96.20,62.34' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='11.46' y='76.26' font-size='7.5pt' font-weight='bold' font-family='Arial'>Interest Group<\\/text>\\n   <polyline points='106.88,236.21 106.88,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='124.68,236.21 124.68,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='142.48,236.21 142.48,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='160.28,236.21 160.28,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text transform='translate(98.96,256.64) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Low<\\/text>\\n   <text transform='translate(61.71,311.70) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>HighSchoolOrCollege<\\/text>\\n   <text transform='translate(116.08,275.13) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bachelors<\\/text>\\n   <text transform='translate(135.84,273.16) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Graduate<\\/text>\\n   <text x='95.5' y='323.34' font-size='7.5pt' font-weight='bold' font-family='Arial'>Education  level<\\/text>\\n   <rect x='182.91' y='105.96' width='95.55' height='72.96' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\\n   <image x='188.89' y='123.33' width='9.92' height='49.61' preserveAspectRatio='none' xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEsCAYAAAACUNnVAAAAi0lEQVQ4jb2PwQ7DIAxDH2aV+v8/TA9TUUFJm9BpF4Rjx3aA1rQLvs8m0FZBH4Gqzp/KCWuHEqiWAarDMhIXOLLTLwDnGY/i4okXJC4LiOAat354GRZBxmUSWzWmmXUR1jFBA3P3Wbygu22aD/J3M6bhoBet/NlPDKJn5Zz/m9ZdXtUYNxb7pXIz4gOF7QZTWzr4jQAAAABJRU5ErkJggg==' xmlns:xlink='http://www.w3.org/1999/xlink'/>\\n   <text x='202.8' y='168.18' font-size='6pt' font-family='Arial'>4000<\\/text>\\n   <text x='202.8' y='160.33' font-size='6pt' font-family='Arial'>4500<\\/text>\\n   <text x='202.8' y='152.48' font-size='6pt' font-family='Arial'>5000<\\/text>\\n   <text x='202.8' y='144.63' font-size='6pt' font-family='Arial'>5500<\\/text>\\n   <text x='202.8' y='136.79' font-size='6pt' font-family='Arial'>6000<\\/text>\\n   <text x='202.8' y='128.94' font-size='6pt' font-family='Arial'>6500<\\/text>\\n   <text x='188.89' y='118.51' font-size='6pt' font-weight='bold' font-family='Arial'>Recreational (median)<\\/text>\\n   <line x1='188.89' y1='165.31' x2='190.87' y2='165.31' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='188.89' y1='157.47' x2='190.87' y2='157.47' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='188.89' y1='149.62' x2='190.87' y2='149.62' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='188.89' y1='141.77' x2='190.87' y2='141.77' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='188.89' y1='133.92' x2='190.87' y2='133.92' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='188.89' y1='126.07' x2='190.87' y2='126.07' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='165.31' x2='198.81' y2='165.31' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='157.47' x2='198.81' y2='157.47' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='149.62' x2='198.81' y2='149.62' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='141.77' x2='198.81' y2='141.77' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='133.92' x2='198.81' y2='133.92' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='196.83' y1='126.07' x2='198.81' y2='126.07' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='96.2' y='43.16' font-size='9pt' font-weight='bold' font-family='Arial'>Annual Recreation spending<\\/text>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c5)'>\\n   <rect x='284.44' y='28.58' width='286.08' height='302.83' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c6)'>\\n   <rect x='375.15' y='51.66' width='74.76' height='181.56' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e41' x='376.93' y='213.64' width='17.8' height='17.8' fill='#FFB342' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.624928666'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e42' x='376.93' y='195.84' width='17.8' height='17.8' fill='#FFD8A1' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.411834804'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e43' x='376.93' y='178.04' width='17.8' height='17.8' fill='#FFCE89' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.467859308'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e44' x='376.93' y='160.24' width='17.8' height='17.8' fill='#FFFBF5' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.215116214'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e45' x='376.93' y='142.44' width='17.8' height='17.8' fill='#FFE2B9' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.3554842595'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e46' x='376.93' y='124.64' width='17.8' height='17.8' fill='#FFFFFF' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.1915564965'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e47' x='376.93' y='106.84' width='17.8' height='17.8' fill='#FFEED7' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.28441375'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e48' x='376.93' y='89.04' width='17.8' height='17.8' fill='#FFF6E9' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.2433726245'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e49' x='376.93' y='71.24' width='17.8' height='17.8' fill='#FFECD2' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.295557198'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e50' x='376.93' y='53.44' width='17.8' height='17.8' fill='#FFA500' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.707950782'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e51' x='394.73' y='213.64' width='17.8' height='17.8' fill='#FFD498' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.4318536215'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e52' x='394.73' y='195.84' width='17.8' height='17.8' fill='#FFDDAE' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.380397226'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e53' x='394.73' y='178.04' width='17.8' height='17.8' fill='#FFE1B8' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.357131296'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e54' x='394.73' y='160.24' width='17.8' height='17.8' fill='#FFDFB3' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.36821258'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e55' x='394.73' y='142.44' width='17.8' height='17.8' fill='#FFC97D' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.495453274'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e56' x='394.73' y='124.64' width='17.8' height='17.8' fill='#FFCC84' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.479799871'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e57' x='394.73' y='106.84' width='17.8' height='17.8' fill='#FFE8C7' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.320874702'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e58' x='394.73' y='89.04' width='17.8' height='17.8' fill='#FFDDAD' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.3835529375'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e59' x='394.73' y='71.24' width='17.8' height='17.8' fill='#FFD59A' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.428059468'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e60' x='394.73' y='53.44' width='17.8' height='17.8' fill='#FFCE89' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.466716971'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e61' x='412.53' y='213.64' width='17.8' height='17.8' fill='#FFD69C' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.422610104'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e62' x='412.53' y='195.84' width='17.8' height='17.8' fill='#FFB445' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.619208795'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e63' x='412.53' y='178.04' width='17.8' height='17.8' fill='#FFB23F' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.631431974'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e64' x='412.53' y='160.24' width='17.8' height='17.8' fill='#FFCE89' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.467131409'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e65' x='412.53' y='142.44' width='17.8' height='17.8' fill='#FFCB81' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.4856857355'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e66' x='412.53' y='124.64' width='17.8' height='17.8' fill='#FFC97C' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.499072499'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e67' x='412.53' y='106.84' width='17.8' height='17.8' fill='#FFC470' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.5260329545'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e68' x='412.53' y='89.04' width='17.8' height='17.8' fill='#FFE1B7' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.35819468'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e69' x='412.53' y='71.24' width='17.8' height='17.8' fill='#FFB03A' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.641308283'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e70' x='412.53' y='53.44' width='17.8' height='17.8' fill='#FFE5C0' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.338479764'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e71' x='430.33' y='213.64' width='17.8' height='17.8' fill='#FFF1DD' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.2706971075'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e72' x='430.33' y='195.84' width='17.8' height='17.8' fill='#FFC26B' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.536881382'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e73' x='430.33' y='178.04' width='17.8' height='17.8' fill='#FFAF36' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.646977694'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e74' x='430.33' y='160.24' width='17.8' height='17.8' fill='#FFBD5D' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.568405413'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e75' x='430.33' y='142.44' width='17.8' height='17.8' fill='#FFAC29' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.6693318955'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e76' x='430.33' y='124.64' width='17.8' height='17.8' fill='#FFC168' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.543218407'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e77' x='430.33' y='106.84' width='17.8' height='17.8' fill='#FFBF62' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.557577741'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e78' x='430.33' y='89.04' width='17.8' height='17.8' fill='#FFD497' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.4359357315'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e79' x='430.33' y='71.24' width='17.8' height='17.8' fill='#FFC97D' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.495487226'/>\\n   <rect id='svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_e80' x='430.33' y='53.44' width='17.8' height='17.8' fill='#FFCB81' fill-opacity='1' stroke='#000000' stroke-opacity='1' stroke-width='0.43' stroke-linejoin='miter' stroke-linecap='butt' title='0.486920328'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d_c1)'>\\n   <text x='363.38' y='225.97' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>A<\\/text>\\n   <text x='363.38' y='208.17' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>B<\\/text>\\n   <text x='362.85' y='190.37' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>C<\\/text>\\n   <text x='362.85' y='172.57' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>D<\\/text>\\n   <text x='363.38' y='154.77' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>E<\\/text>\\n   <text x='363.91' y='136.97' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>F<\\/text>\\n   <text x='362.31' y='119.17' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>G<\\/text>\\n   <text x='362.85' y='101.37' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>H<\\/text>\\n   <text x='367.11' y='83.57' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>I<\\/text>\\n   <text x='364.98' y='65.77' font-size='7.2pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>J<\\/text>\\n   <polyline points='372.16,222.54 375.15,222.54' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,204.74 375.15,204.74' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,186.94 375.15,186.94' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,169.14 375.15,169.14' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,151.34 375.15,151.34' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,133.54 375.15,133.54' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,115.74 375.15,115.74' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,97.94 375.15,97.94' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,80.14 375.15,80.14' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='372.16,62.34 375.15,62.34' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='290.41' y='76.26' font-size='7.5pt' font-weight='bold' font-family='Arial'>Interest Group<\\/text>\\n   <polyline points='385.83,236.21 385.83,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='403.63,236.21 403.63,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='421.43,236.21 421.43,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='439.23,236.21 439.23,233.22' fill='none' stroke='#4D4D4D' stroke-opacity='1' stroke-width='1.16' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text transform='translate(377.92,256.64) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Low<\\/text>\\n   <text transform='translate(340.67,311.70) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>HighSchoolOrCollege<\\/text>\\n   <text transform='translate(395.03,275.13) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bachelors<\\/text>\\n   <text transform='translate(414.80,273.16) rotate(-45.00)' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Graduate<\\/text>\\n   <text x='374.46' y='323.34' font-size='7.5pt' font-weight='bold' font-family='Arial'>Education  level<\\/text>\\n   <rect x='461.87' y='105.96' width='102.68' height='72.96' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\\n   <image x='467.85' y='123.33' width='9.92' height='49.61' preserveAspectRatio='none' xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEsCAYAAAACUNnVAAAAeklEQVQ4jc1SQQ7AIAhr8f/P2Dvdwc3sUJTpSHYx1EApUNQD1YACAwuuqD0GA+2OFAT7H3sKPUhRQS9lCAMpD4ggKeakGMoQBKpsUuHKUHO4symlSkaUVKlK7hFdzrClL+PDyX+pavU8by644IhcE257cttwOXwrGzoBjrsGU6J/hDkAAAAASUVORK5CYII=' xmlns:xlink='http://www.w3.org/1999/xlink'/>\\n   <text x='481.75' y='174.92' font-size='6pt' font-family='Arial'>0.2<\\/text>\\n   <text x='481.75' y='165.34' font-size='6pt' font-family='Arial'>0.3<\\/text>\\n   <text x='481.75' y='155.77' font-size='6pt' font-family='Arial'>0.4<\\/text>\\n   <text x='481.75' y='146.19' font-size='6pt' font-family='Arial'>0.5<\\/text>\\n   <text x='481.75' y='136.62' font-size='6pt' font-family='Arial'>0.6<\\/text>\\n   <text x='481.75' y='127.04' font-size='6pt' font-family='Arial'>0.7<\\/text>\\n   <text x='467.85' y='118.51' font-size='6pt' font-weight='bold' font-family='Arial'>Joviality Index (median)<\\/text>\\n   <line x1='467.85' y1='172.05' x2='469.83' y2='172.05' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='467.85' y1='162.48' x2='469.83' y2='162.48' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='467.85' y1='152.9' x2='469.83' y2='152.9' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='467.85' y1='143.33' x2='469.83' y2='143.33' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='467.85' y1='133.75' x2='469.83' y2='133.75' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='467.85' y1='124.18' x2='469.83' y2='124.18' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='172.05' x2='477.77' y2='172.05' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='162.48' x2='477.77' y2='162.48' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='152.9' x2='477.77' y2='152.9' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='143.33' x2='477.77' y2='143.33' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='133.75' x2='477.77' y2='133.75' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <line x1='475.78' y1='124.18' x2='477.77' y2='124.18' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='375.15' y='43.16' font-size='9pt' font-weight='bold' font-family='Arial'>Joviality Index<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_6c0b54ed_6a7e_4d93_938f_cabd09184e5d\",\"ratio\":1.6,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nFrom the plot above, we are able to see the link between different education levels and their interests group. Hovering the mouse above the heatmaps will reveal the annual recreation spending and joviality index in the tooltip. The median joviality index is chosen because it is a point where the maximum distance between the smallest and highest spending or index is reduced. What inteeresting patterns can you see?\n\nI can see that interest group J has higher recreation spending as compared to the rest and residents from the 'low' education level are contributing to it. From the joviality heatmap on the right, I also notice the same group of people are happiest of all. It makes me wonder what interest group it is in real life.\n\nI will be performing CDA to compare the annual recreation spends in joviality index across education levels later.\n\n### 3.1.4 Interactive bubble plots of (Savings, Recreation, Shelter, Food and Jovality) against wage\n\nPending\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 3.2 CDA\n\n### 3.2.1 Normality assumptions of annual wage\n\nWe will first perform a test to confirm whether wage follows the normal distribution.\n\n*H0: The wage does not follow a normal distribution.*\n\n*H1: The wage follows a normal distribution.*\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nqq <- ggplot(annual,\n       aes(sample=Wage)) +  #<<< use a new argument call sample: el scores\n  \n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"QQ plot with Shapiro-Wilk test results\")  # add plot title\n\nsw_t <- shapiro_test(annual$Wage) %>% \n  as_tibble() %>% \n  mutate(variable = \"Wage\")%>% gt()  #<<< make into a gt format (will give a nice table)  shapiro.test is not used here as it gives output in another format.\n\ntmp <- tempfile(fileext = '.png') # create  temp table\ngtsave(sw_t, tmp)  # use gtsave() to save sw_t into tmp folder\ntable_png <- png::readPNG(tmp, native = TRUE)\n\nqq+table_png\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\nFrom the Shapiro test , p-value \\< 0.05 and we have enough statistical evidence to reject the null hypothesis and conclude that **Wage** does not follow the normal distribution.\n\n### 3.2.2 One-way Anova plots to compare Wage/Recreation/Joviality across Education levels\n\n#### (1) Does a person earn more if he/she is more highly educated in the city?\n\nSince Wage does not follow normal distribution, I will choose a non parametric test to compare whether there is significant difference in the median of wage between education levels.\n\n\n::: {.cell fig.aspect='fig-width*0.618'}\n\n```{.r .cell-code  code-fold=\"true\"}\nggbetweenstats(data = annual, x = educationLevel, y = Wage,\n               xlab = \"Education level\", ylab = \"Annual Wage\",\n               type = \"np\", pairwise.comparisons = TRUE, pairwise.display = \"s\",\n               sort = \"descending\",\n               sort.fun = median,\n               mean.ci = T, p.adjust.method = \"fdr\",  conf.level = 0.95,\n               title = \"Comparison of Median Annual Wage across Education Levels\") +\n  scale_y_continuous(limits = c(0, 300000)) +\n   theme(axis.title.y=element_text(angle = 0,\n                                  vjust=0.9))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=960}\n:::\n:::\n\n\nFor 4 categories of education levels, we can have a total of 4C2 = k(k-1)/2 (=6) possible combinations of pairs.\n\nFrom the results, all six pairwise comparison p-values are less than 0.05 and thus we can reject the null hypothesis and conclude that the median wages across all different educational levels are all different from one another.\n\n#### (1.1) Visualising the uncertainty of point estimates\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nannual %>%\n  ggplot(aes(x = educationLevel, y = Wage)) +\n  \n  #Using stat_pointinterval to plot the points and intervals\n  stat_pointinterval(.width = c(0.95,0.99),\n  .point = median,\n  .interval = qi,\n  aes(interval_color=stat(level)),\n  show.legend = FALSE) +\n  \n  #Defining the color of the intervals \n  scale_color_manual(\n    values = c(\"blue\", \"darkblue\"),\n    aesthetics = \"interval_color\") +\n  \n  #Title, subtitle, and caption\n  labs(\n    title = \"Visualising confidence intervals of median math score\",\n    subtitle = \"Median Point + Multiple-interval plot, 95% and 99%\",\n    x = \"Education  level\", y = \"Wage\") +\n  \n  theme_ipsum() +\n  \n  theme(axis.title.y=element_text(angle = 0, \n                                  vjust=0.9, \n                                  size = 10, \n                                  face='bold'),\n        axis.title.x=element_text(size = 10,\n                                   face='bold'),\n        plot.title = element_text(size = 12,\n                                  face='bold'),\n        panel.border = element_blank(),\n        panel.grid.major = element_blank())\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\nThe error bar for mean Median Wage is the longest for Graduate education level and this could be due to outliers in this category.\n\n#### (2) Is there a significant difference in the median of recreational spending across education levels?\n\nPerform a test to confirm whether recreational spending follows the normal distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nqq <- ggplot(annual,\n       aes(sample=Recreation)) + \n  \n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"QQ plot with Shapiro-Wilk test results\")  \n\nsw_t <- shapiro_test(annual$Recreation) %>% \n  as_tibble() %>% \n  mutate(variable = \"Recreation Spending\")%>% gt()  \n\ntmp <- tempfile(fileext = '.png') # create  temp table\ngtsave(sw_t, tmp)  # use gtsave() to save sw_t into tmp folder\ntable_png <- png::readPNG(tmp, native = TRUE)\n\nqq+table_png\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\nWe have enough statistical evidence to reject the null hypothesis that recreational spending follows normal distribution. Use a non parametric test below to test for difference in median of recreation spending across education levels.\n\n\n::: {.cell fig.aspect='fig-width*0.618'}\n\n```{.r .cell-code  code-fold=\"true\"}\nggbetweenstats(data = annual, x = educationLevel, y = Recreation,\n               xlab = \"Education level\", ylab = \"Annual Recreation\",\n               type = \"np\", pairwise.comparisons = TRUE, pairwise.display = \"ns\",\n               sort = \"descending\",\n               sort.fun = median,\n               mean.ci = T, p.adjust.method = \"fdr\",  conf.level = 0.95,\n               title = \"Comparison of Median Annual Recreation spending across Education Levels\") +\n  scale_y_continuous(limits = c(0, 20000)) +\n   theme(axis.title.y=element_text(angle = 0,\n                                  vjust=0.9))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-39-1.png){width=960}\n:::\n:::\n\n\nFrom the results, all six pairwise comparison p-values are greater 0.05 and thus we do not have enough statistical evidence to reject the null hypothesis that the median recreation spending across all different educational levels are all different.\n\n#### (3) Is there a significant difference in median of the joviality index across education levels?\n\nPerform a test to confirm whether joviality index follows the normal distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nqq <- ggplot(annual,\n       aes(sample=joviality)) + \n  \n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"QQ plot with Shapiro-Wilk test results\")  \n\nsw_t <- shapiro_test(annual$joviality) %>% \n  as_tibble() %>% \n  mutate(variable = \"Joviality Index\")%>% gt()  \n\ntmp <- tempfile(fileext = '.png') # create  temp table\ngtsave(sw_t, tmp)  # use gtsave() to save sw_t into tmp folder\ntable_png <- png::readPNG(tmp, native = TRUE)\n\nqq+table_png\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\nWe have enough statistical evidence to reject the null hypothesis that joviality index follows normal distribution. Use a non parametric test below to test for difference in median of joviality index across education levels.\n\n\n::: {.cell fig.aspect='fig-width*0.618'}\n\n```{.r .cell-code  code-fold=\"true\"}\nggbetweenstats(data = annual, x = educationLevel, y = joviality,\n               xlab = \"Education level\", ylab = \"Joviality Index\",\n               type = \"np\", pairwise.comparisons = TRUE, pairwise.display = \"ns\",\n               sort = \"descending\",\n               sort.fun = median,\n               mean.ci = T, p.adjust.method = \"fdr\",  conf.level = 0.95,\n               title = \"Comparison of Median Joviality index across Education Levels\") +\n  scale_y_continuous(limits = c(0, 2)) +\n   theme(axis.title.y=element_text(angle = 0,\n                                  vjust=0.9))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-41-1.png){width=960}\n:::\n:::\n\n\nFrom the results, only 2 pairwise comparison p-values \\<0.05 and thus we can reject the null hypothesis for (High School & Graduate) and (High School & Bachelors) and conclude that the median Joviality index for these two pairs of education levels are different.\n\n### 3.2.3 Correlation between Annual Shelter cost and Annual Wage\n\nIn this section, we will investigate if people who earn more will also spend more on shelter. We will also subset the data across education levels.\n\nWe will use the non-parametric Spearman correlation analysis instead of Pearson correlation since the wage data is not normally distributed.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlow_correl <- ggscatterstats(data = annual |> filter(educationLevel == \"Low\"), \n                           x = Wage, y = Shelter,\n                           type = \"nonparametric\") + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  scale_x_continuous(limits = c(0, 70000), \n                     breaks=seq(0, 70000, 10000), \n                     labels= comma) + \n  scale_y_continuous(limits = c(0, 20000), \n                     breaks=seq(0, 20000, 5000), \n                     labels= comma) +\n  \n  labs(title = \"Low Education Status\", \n       x = \"Annual Wage\", y = \"Annual Shelter fee\") \n\n\n\nhigh_correl <- ggscatterstats(data = annual |> filter(educationLevel == \"HighSchoolOrCollege\"), \n                           x = Wage, y = Shelter,\n                           type = \"nonparametric\") + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  scale_x_continuous(limits = c(0, 70000), \n                     breaks=seq(0, 70000, 10000), \n                     labels= comma) + \n  scale_y_continuous(limits = c(0, 20000), \n                     breaks=seq(0, 20000, 5000), \n                     labels= comma) +\n  \n  labs(title = \"High Sch Education Status\", \n       x = \"Annual Wage\", y = \"Annual Shelter fee\") \n\n\n\nbac_correl <- ggscatterstats(data = annual |> filter(educationLevel == \"Bachelors\"), \n                           x = Wage, y = Shelter,\n                           type = \"nonparametric\") + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  scale_x_continuous(limits = c(0, 70000), \n                     breaks=seq(0, 70000, 10000), \n                     labels= comma) + \n  scale_y_continuous(limits = c(0, 20000), \n                     breaks=seq(0, 20000, 5000), \n                     labels= comma) +\n  \n  labs(title = \"Degree Education Status\", \n       x = \"Annual Wage\", y = \"Annual Shelter fee\") \n\n\ngrad_correl <- ggscatterstats(data = annual |> filter(educationLevel == \"Graduate\"), \n                           x = Wage, y = Shelter,\n                           type = \"nonparametric\") + \n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  scale_x_continuous(limits = c(0, 70000),\n                     breaks=seq(0, 70000, 10000), \n                     labels= comma) + \n  scale_y_continuous(limits = c(0, 20000),\n                     breaks=seq(0, 20000, 5000), \n                     labels= comma) +\n  \n  labs(title = \"Graduate Education Status\", \n       x = \"Annual Wage\", y = \"Annual Shelter fee\") \n\n\n# combining plots using patchwork\np_correl <- (low_correl + high_correl) / (bac_correl + grad_correl) + plot_spacer()\np_correl + plot_annotation(title = \"Correlation between Shelter spending and Annual Wage\", \n                           theme = theme(plot.title = element_text(size = 18),\n                                         plot.subtitle = element_text(size = 12)))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png){width=960}\n:::\n:::\n\n\nH0: There is no \\[monotonic\\] association between the annual shelter fees and wage.\n\nH1: There is association between the annual shelter fees and wage.\n\nFrom the plots above, there are no strong correlation values above 0.7. only the 'low' and 'degree' education group showed p-values less than 0.05 which shows that there is a significant association between shelter fee and wage. However, the correlation is weak between shelter spending and wage.\n\n::: callout-note\nSpearman correlation\n\nThe Spearman correlation is not a linear correlation of the data, but a linear correlation of a transformed version of the data \\-- specifically, the correlation of the rank-transformed data. Do not be mislead by the slope direction.\n:::\n\n### \n\n# 4 References\n\nHeat Map with ggplot2. (2023). Retrieved May 9, 2023, from <https://r-charts.com/correlation/heat-map-ggplot2/#:~:text=Heat%20map%20with%20geom_tile,-A%20heap%20map&text=You%20can%20customize%20the%20border,%2C%20lwd%20and%20linetype%20%2C%20respectively.&text=In%20addition%2C%20you%20can%20add,argument%20of%20the%20aes%20function>.\n\n\nDownward slope but Spearman correlation coefficient is positive (and vice versa). (2022, April 5). In Stack Exchange. Retrieved May 9, 2023, from <https://stats.stackexchange.com/questions/545516/downward-slope-but-spearman-correlation-coefficient-is-positive-and-vice-versa>\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n<script src=\"../../site_libs/d3-bundle-5.16.0/d3-bundle.min.js\"></script>\r\n<script src=\"../../site_libs/d3-lasso-0.0.5/d3-lasso.min.js\"></script>\r\n<script src=\"../../site_libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js\"></script>\r\n<script src=\"../../site_libs/flatbush-4.0.0/flatbush.min.js\"></script>\r\n<link href=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.js\"></script>\r\n<script src=\"../../site_libs/girafe-binding-0.8.7/girafe.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}